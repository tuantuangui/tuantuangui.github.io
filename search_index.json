[["index.html", "MNet Chapter 1 Introduction &amp; Installation 1.1 Overview of Workflow 1.2 Installation", " MNet Tuantuan Gui and Hai Fang 2023-04-23 Chapter 1 Introduction &amp; Installation Technological advances in metabolomics make it increasingly reliable to comprehensively detect and quantify small compounds in an unbiased manner. With the reduced costs come a wide range of applications, for example, in epidemiological, genetic and clinical studies. Meanwhile, integrated analyses of metabolomics with other omics, for example, gene expression transcriptomic datasets, are receiving the increasing attention, most of these existing tools, however, only deal with individual pathways or can’t extract the subnetwork involving multiple pathways; in other words, they do not consider the network knowledge of gene-metabolite or metabolite-metabolite relations hidden in available metabolic pathways. Here we present “MNet”, an R package enabling network-based integration of metabolomics with clinical and transcriptomic data. 1.1 Overview of Workflow The package MNet is designed to provide a collection of functionalities aiding in metabolome data interpretation together with clinical data and gene expression data. It not only supports the routine analyses and visualisations in terms of metabolomic datasets (including but not limited to: differential metabolites analyses/visualisations/feature selection), the differential abundance analyses which is designed to detect which pathways are differentially abundant between two conditions, but also is capable of carrying out integrated analysis of metabolic and clinical data (such as ggcor package), integrated analysis of metabolic and gene expression data (the metabolite and gene pathway analyses and the subnetwork analyses of metabolite-gene network analyses). Also supported is the time series analysis with the help of other packages (mFuzz package and supraHex package). 1.2 Installation The R package MNet requires R version 4.0.0 or higher, please see https://cran.r-project.org. #The package ggcor and XGR are from GitHub. Hence, it is recommended to install the package before installing MNet. #Please install it via github. if(!require(devtools)){ install.packages(&quot;devtools&quot;) } #devtools::install_github(&quot;Github-Yilei/ggcor&quot;) #devtools::install_github(&quot;hfang-bristol/XGR&quot;) MNet is available for all operating systems and can be installed via the Github. devtools::install_github(&quot;tuantuangui/MNet&quot;) library(MNet) check the package ‘MNet’ successfully installed library(help=MNet) "],["example-unique-analyses.html", "Chapter 2 Example-unique analyses 2.1 Loading the data 2.2 Pathway enrichment analysis 2.3 Pathway differential abundance score 2.4 MSEA Metabolite Set Enrichment Analysis 2.5 Subnetwork analysis of Metabolism and transcriptome data from TNBC: 2.6 Subnetwork analysis of interested metabolites and genes", " Chapter 2 Example-unique analyses 2.1 Loading the data The case study is an integrated metabolic and transcriptional analysis to understand the rapidly proliferating breast cancers (Liao, et al., 2022). In this paper, the authors characterized the metabolomic profile of two types of 31 breast tumors in human to uncovered pyrimidine metabolism and glutaminolysis pathways are elevated in TNBC. As an example of mixed metabolites and genes analyses, here we are going to use both the dataset of metabolite and gene expression data as reported in the paper. The metabolomics data was accessed from the Supplementary Tables S2 in the paper, and the gene expression data is from the author. They found that pyrimidine and purine metabolism, carbon metabolism, and the energy production related pathways were highly enriched in Cluster 2 while many lipid/fatty acid metabolism related pathways were enriched in Cluster 1. We will use MNet to identify a set of features whose activity changes significantly between the two sample clusters.This result will hopefully hint at some specific biological activities that are pathologically altered in tumoral samples. library(dplyr) library(MNet) library(stringr) library(ggplot2) library(RColorBrewer) #load(&quot;data/meta_dat.rda&quot;) #load(&quot;data/gene_dat.rda&quot;) #load(&quot;data/group.rda&quot;) diff_meta &lt;- mlimma(meta_dat,group) diff_gene &lt;- mlimma(gene_dat,group) head(diff_meta) ## # A tibble: 6 × 8 ## logFC AveExpr t P.Value adj.P.Val B logP name ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 2.86 22.6 9.25 1.52e-10 0.0000000332 14.1 7.48 C02045 ## 2 2.44 26.2 7.80 6.83e- 9 0.000000748 10.4 6.13 C00267 ## 3 -1.82 27.1 -6.80 1.10e- 7 0.00000622 7.64 5.21 C00073 ## 4 -3.78 20.9 -6.79 1.14e- 7 0.00000622 7.61 5.21 C05674 ## 5 -2.20 21.4 -6.58 2.07e- 7 0.00000907 7.02 5.04 C00255 ## 6 -2.37 21.6 -6.45 2.98e- 7 0.0000109 6.66 4.96 C00242 head(diff_gene) ## # A tibble: 6 × 8 ## logFC AveExpr t P.Value adj.P.Val B logP name ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 6.92 23.1 11.3 1.15e-12 0.0000000203 17.7 7.69 APH1B ## 2 21.4 23.4 10.6 5.13e-12 0.0000000455 16.5 7.34 GFRA1 ## 3 -5.76 24.4 -10.1 1.85e-11 0.0000000891 15.4 7.05 RFC4 ## 4 10.5 14.8 10.1 2.01e-11 0.0000000891 15.3 7.05 FAM47E ## 5 -10.8 20.6 -9.79 3.85e-11 0.000000137 14.7 6.86 ORC6 ## 6 4.02 5.65 9.69 4.98e-11 0.000000147 14.5 6.83 FAM87B 2.2 Pathway enrichment analysis 2.2.1 Extended pathway enrichment KEGG metabolic pathway-based extended pathway enrichment (EPE) analysis to investigate the dysregulation of metabolic pathways considering both metabolites and genes using the function ‘PathwayAnalysis’. ## combine the metabolite information and gene information all_dat &lt;- rbind(diff_gene,diff_meta) ## filter the increase differential genes and metabolites all_dat1 &lt;- all_dat %&gt;% dplyr::filter(logFC&gt;0.58) %&gt;% dplyr::filter(adj.P.Val &lt; 0.05) ## the increase pathway analysis of both genes and metabolites result1 &lt;- PathwayAnalysis(all_dat1$name,out=&quot;Extended&quot;,p_cutoff=0.01) ggsave(&quot;result_v0131/EPE1.png&quot;,result1$gp,width=30,height = 5) ggsave(&quot;result_v0131/EPE_gene_meta_cluster1.png&quot;,result1$p_barplot,width=10,height = 10) ## filter the decrease differential genes and metabolites all_dat2 &lt;- all_dat %&gt;% dplyr::filter(logFC &lt; -0.58) %&gt;% dplyr::filter(adj.P.Val &lt; 0.05) result2 &lt;- PathwayAnalysis(all_dat2$name,out=&quot;Extended&quot;,p_cutoff=0.01) ggsave(&quot;result_v0131/EPE2.png&quot;,result2$gp,width=30,height=5) ggsave(&quot;result_v0131/EPE_gene_meta_cluster2.png&quot;,result2$p_barplot,width=10,height = 10) p &lt;- cowplot::plot_grid(plotlist = list(result1$p_barplot,result2$p_barplot)) ggsave(&quot;result_v0131/EPE_gene_meta.png&quot;,p,width=20,height = 10) 2.2.2 metabolite pathway enrichment KEGG metabolic pathway-based pathway enrichment (PE) analysis to investigate the dysregulation of metabolic pathways considering metabolites. all_dat &lt;- diff_meta all_dat1 &lt;- all_dat %&gt;% dplyr::filter(logFC&gt;0.58) %&gt;% dplyr::filter(adj.P.Val &lt; 0.05) result1 &lt;- PathwayAnalysis(all_dat1$name,out=&quot;metabolite&quot;,p_cutoff=0.1) ggsave(&quot;result_v0131/PE_meta1.png&quot;,result1$gp,width=5,height = 10) write.table(result1$output,&quot;result_v0131/PE_meta1.txt&quot;,quote=F,row.names=F,sep=&quot;\\t&quot;) ggsave(&quot;result_v0131/PE_meta_cluster1.png&quot;,result1$p_barplot,width=10,height = 10) all_dat2 &lt;- all_dat %&gt;% dplyr::filter(logFC &lt; -0.58) %&gt;% dplyr::filter(adj.P.Val &lt; 0.05) result2 &lt;- PathwayAnalysis(all_dat2$name,out=&quot;metabolite&quot;,p_cutoff=0.1) write.table(result2$output,&quot;result_v0131/PE_gene2.txt&quot;,quote=F,row.names=F,sep=&quot;\\t&quot;) ggsave(&quot;result_v0131/PE_meta2.png&quot;,result2$gp,width=15,height = 5) ggsave(&quot;result_v0131/PE_meta_cluster2.png&quot;,result2$p_barplot,width=10,height = 10) p &lt;- cowplot::plot_grid(plotlist = list(result1$p_barplot,result2$p_barplot)) ggsave(&quot;result_v0131/PE_meta.png&quot;,p,width=20,height = 10) 2.2.3 gene pathway enrichment KEGG metabolic pathway-based pathway enrichment (PE) analysis to investigate the dysregulation of metabolic pathways considering genes. 因为基因差异注释后的比较少，所以选择阈值小点的 all_dat &lt;- diff_gene all_dat1 &lt;- all_dat %&gt;% dplyr::filter(logFC&gt;0.58) %&gt;% dplyr::filter(adj.P.Val &lt; 0.05) result1 &lt;- PathwayAnalysis(all_dat1$name,out=&quot;gene&quot;,p_cutoff=0.1) write.table(result1$output,&quot;result_v0131/PE_gene1.txt&quot;,quote=F,row.names=F,sep=&quot;\\t&quot;) ggsave(&quot;result_v0131/PE_gene1.png&quot;,result1$gp,width=30,height = 10) ggsave(&quot;result_v0131/PE_gene_cluster1.png&quot;,result1$p_barplot,width=10,height = 10) all_dat2 &lt;- all_dat %&gt;% dplyr::filter(logFC &lt; -0.58) %&gt;% dplyr::filter(adj.P.Val &lt; 0.05) result2 &lt;- PathwayAnalysis(all_dat2$name,out=&quot;gene&quot;,p_cutoff=0.1) write.table(result2$output,&quot;result_v0131/PE_gene2.txt&quot;,quote=F,row.names=F,sep=&quot;\\t&quot;) ggsave(&quot;result_v0131/PE_gene2.png&quot;,result2$gp,width=25,height = 5) ggsave(&quot;result_v0131/PE_gene_cluster2.png&quot;,result2$p_barplot,width=10,height = 10) p &lt;- cowplot::plot_grid(plotlist = list(result1$p_barplot,result2$p_barplot)) ggsave(&quot;result_v0131/PE_gene.png&quot;,p,width=20,height = 10) 2.3 Pathway differential abundance score 2.3.1 Extended pathway differential abundance score KEGG metabolic pathway-based extended differential abundance (EDA) analysis investigate the dysregulation of metabolic pathways considering both metabolites and genes. diff_gene_increase &lt;- diff_gene %&gt;% dplyr::filter(logFC&gt;0.58) %&gt;% dplyr::filter(adj.P.Val &lt; 0.05) diff_gene_decrease &lt;- diff_gene %&gt;% dplyr::filter(logFC &lt; -0.58) %&gt;% dplyr::filter(adj.P.Val &lt; 0.05) diff_meta_increase &lt;- diff_meta %&gt;% dplyr::filter(logFC&gt;0.58) %&gt;% dplyr::filter(adj.P.Val &lt; 0.05) diff_meta_decrease &lt;- diff_meta %&gt;% dplyr::filter(logFC &lt; -0.58) %&gt;% dplyr::filter(adj.P.Val &lt; 0.05) ExtendDAscore_result &lt;- DAscore(c(diff_gene_increase$name,diff_meta_increase$name),c(diff_gene_decrease$name,diff_meta_decrease$name),c(diff_gene$name,diff_meta$name),min_measured_num = 2,out=&quot;Extended&quot;) ggsave(&quot;result_v0131/EDA.png&quot;,ExtendDAscore_result$p,width=10,height = 15) 2.3.2 metabolite differential abundance score KEGG metabolic pathway-based differential abundance (DA) analysis investigate the dysregulation of metabolic pathways considering only metabolites. diff_meta_increase &lt;- diff_meta %&gt;% dplyr::filter(logFC &gt; 0.58) %&gt;% dplyr::filter(adj.P.Val &lt; 0.05) diff_meta_decrease &lt;- diff_meta %&gt;% dplyr::filter(logFC &lt; -0.58) %&gt;% dplyr::filter(adj.P.Val &lt; 0.05) dascore_result_meta &lt;- DAscore(diff_meta_increase$name,diff_meta_decrease$name,diff_meta$name,out=&quot;metabolite&quot;) ggsave(&quot;result_v0131/DAscore_metabolite.png&quot;,dascore_result_meta$p,width=10,height = 15) 2.3.3 gene differential abundance score KEGG metabolic pathway-based differential abundance (DA) analysis investigate the dysregulation of metabolic pathways considering only genes. diff_gene_increase &lt;- diff_gene %&gt;% dplyr::filter(logFC &gt; 0.58) %&gt;% dplyr::filter(adj.P.Val &lt; 0.05) diff_gene_decrease &lt;- diff_gene %&gt;% dplyr::filter(logFC &lt; -0.58) %&gt;% dplyr::filter(adj.P.Val &lt; 0.05) dascore_result_gene &lt;- DAscore(diff_gene_increase$name,diff_gene_decrease$name,diff_gene$name,out=&quot;gene&quot;) ggsave(&quot;result_v0131/DAscore_gene.png&quot;,dascore_result_gene$p,width=10,height = 15) 2.4 MSEA Metabolite Set Enrichment Analysis the metabolite set enrichment analysis using function “MSEA” result &lt;- MSEA(sim.cpd.data) result$leadingEdge &lt;- as.character(result$leadingEdge) write.table(result,file=&quot;result_v0131/MSEA.txt&quot;,quote=F,row.names=F,sep=&quot;\\t&quot;) the msea plot of interested pathway p &lt;- pMSEA(&quot;Butanoate metabolism&quot;,sim.cpd.data) ggsave(&quot;result_v0131/MSEA_Butanoate.png&quot;,p,width=5,height = 4) 2.5 Subnetwork analysis of Metabolism and transcriptome data from TNBC: the data need to have the column name “name”, and have the “p_value”,“logFC” is alternative. If have the “logFC”, the color in the figure is the logFC, otherwise, the color “blue” in figure means metabolites and the color “red” means the genes. names(diff_meta)[4] &lt;- &quot;p_value&quot; diff_metabolite &lt;- diff_meta %&gt;% dplyr::filter(adj.P.Val &lt; 0.01) %&gt;% dplyr::filter(abs(logFC)&gt;1) names(diff_gene)[4] &lt;- &quot;p_value&quot; diff_gene1 &lt;- diff_gene %&gt;% dplyr::filter(adj.P.Val &lt; 0.01) %&gt;% dplyr::filter(abs(logFC)&gt;1) pdf(&quot;result_v0131/subnetwork_important.pdf&quot;) a &lt;- pdnet(diff_meta,diff_gene,nsize=100) dev.off() 2.6 Subnetwork analysis of interested metabolites and genes the data need to have the column name “name”, and do not have the “p_value” pdf(&quot;result_v0131/subnetwork_interested.pdf&quot;) ## get 500 differential expression gene a &lt;- pdnet(diff_metabolite[,8],diff_gene1[1:500,8]) dev.off() write.table(a,&quot;result_v0131/subnetwork_interested_edge.txt&quot;,quote=F,row.names=F,sep=&quot;\\t&quot;) "],["example-rountine-analyses.html", "Chapter 3 Example-rountine analyses 3.1 Metabolite and kegg name change 3.2 Group-wise analyses 3.3 Feature selection 3.4 Pathway analysis 3.5 Clinical analysis", " Chapter 3 Example-rountine analyses 3.1 Metabolite and kegg name change 3.1.1 Metabolite name changed to refmet name This step requires networking RefMet: A Reference list of Metabolite names The main objective of RefMet is to provide a standardized reference nomenclature for both discrete metabolite structures and metabolite species identified by spectroscopic techniques in metabolomics experiments. compound_name &lt;- c(&quot;2-Hydroxybutyric acid&quot;,&quot;1-Methyladenosine&quot;,&quot;tt&quot;,&quot;2-Aminooctanoic acid&quot;) refmetid_result &lt;- name2refmet(compound_name) write.table(refmetid_result,&quot;result_v0131/refmetid_result.txt&quot;,quote=F,sep=&quot;\\t&quot;,row.names=F) ## Input name refmet_name formula exactmass super_class ## 1 1-Methyladenosine 1-Methyladenosine C11H15N5O4 281.1124 Nucleic acids ## 2 2-Hydroxybutyric acid 2-Hydroxybutyric acid C4H8O3 104.0473 Fatty Acyls ## 3 tt tt &lt;NA&gt; NA &lt;NA&gt; ## 4 2-Aminooctanoic acid 2-Aminooctanoic acid C8H17NO2 159.1259 Organic acids ## main_class sub_class class_index ## 1 Purines Purine ribonucleosides 1330 ## 2 Fatty acids Hydroxy FA 125 ## 3 &lt;NA&gt; &lt;NA&gt; NA ## 4 Amino acids and peptides Amino acids NA 3.1.2 Metabolite name changed to kegg id This step requires networking search the kegg id corresponding to the metabolites name compound_name &lt;- c(&quot;2-Hydroxybutyric acid&quot;,&quot;1-Methyladenosine&quot;,&quot;tt&quot;,&quot;2-Aminooctanoic acid&quot;) keggid_result &lt;- name2keggid(compound_name) %&gt;% tidyr::separate_rows(kegg_id,sep=&quot;;&quot;) %&gt;% tibble::as_tibble() write.table(keggid_result,&quot;result_v0131/keggid_result.txt&quot;,quote=F,sep=&quot;\\t&quot;,row.names=F) ## name kegg_id ## 1 2-Hydroxybutyric acid C05984 ## 2 1-Methyladenosine C02494 ## 3 tt &lt;NA&gt; ## 4 2-Aminooctanoic acid &lt;NA&gt; 3.1.3 Metabolite name corresponding to kegg pathway This step requires networking search the kegg pathway corresponding to the metabolite name compound_name &lt;- c(&quot;2-Hydroxybutyric acid&quot;,&quot;1-Methyladenosine&quot;,&quot;tt&quot;,&quot;2-Aminooctanoic acid&quot;) result_all &lt;- name2pathway(compound_name) ##### the output is the each metabolite related pathway result_name2pathway &lt;- result_all$name2pathway write.table(result_name2pathway,&quot;result_v0131/name2pathway_keggpathway.txt&quot;,quote=F,sep=&quot;\\t&quot;,row.names=F) result_name2keggid &lt;- result_all$kegg_id write.table(result_name2keggid,&quot;result_v0131/name2pathway_keggid.txt&quot;,quote=F,sep=&quot;\\t&quot;,row.names=F) result_name2enrichpathway &lt;- result_all$pathway write.table(result_name2enrichpathway,&quot;result_v0131/name2pathway_pathwayenrich.txt&quot;,quote=F,sep=&quot;\\t&quot;,row.names=F) ## name kegg_id PATHWAY pathwayid ## 1 2-Hydroxybutyric acid C05984 Propanoate metabolism hsa00640 ## name kegg_id ## 1 2-Hydroxybutyric acid C05984 ## 2 1-Methyladenosine C02494 ## 3 tt &lt;NA&gt; ## 4 2-Aminooctanoic acid &lt;NA&gt; ## name nAnno nOverlap fc zscore pvalue adjp or CIl CIu distance ## 1 Propanoate metabolism 40 1 76.1 8.66 0.013 1 Inf 1.93 Inf 1 ## namespace members_Overlap ## 1 Customised C05984 ## members_Anno ## 1 C00024, C00042, C00068, C00083, C00091, C00099, C00100, C00109, C00111, C00163, C00186, C00222, C00424, C00479, C00546, C00583, C00683, C00804, C00827, C00894, C01013, C01213, C02170, C02225, C02335, C02876, C04225, C04593, C05235, C05668, C05979, C05983, C05984, C05989, C06002, C15972, C15973, C21017, C21018, C21250 ## members_Overlap_name ## 1 2-Hydroxybutyric acid ## members_Anno_name ## 1 Acetyl-CoA;Succinate;Thiamin diphosphate;Malonyl-CoA;Succinyl-CoA;beta-Alanine;Propanoyl-CoA;2-Oxobutanoate;Glycerone phosphate;Propanoate;(S)-Lactate;3-Oxopropanoate;(S)-Lactaldehyde;Propanal;Methylglyoxal;Propane-1,2-diol;(S)-Methylmalonyl-CoA;Propynoate;Lactoyl-CoA;Propenoyl-CoA;3-Hydroxypropanoate;(R)-Methylmalonyl-CoA;Methylmalonate;2-Methylcitrate;beta-Alanyl-CoA;Propanoyl phosphate;(Z)-But-2-ene-1,2,3-tricarboxylate;(2S,3R)-3-Hydroxybutane-1,2,3-tricarboxylate;Hydroxyacetone;3-Hydroxypropionyl-CoA;Propane-1-ol;Propionyladenylate;2-Hydroxybutyric acid;3-Oxopropionyl-CoA;(S)-Methylmalonate semialdehyde;Enzyme N6-(lipoyl)lysine;Enzyme N6-(dihydrolipoyl)lysine;2-(alpha-Hydroxypropyl)thiamine diphosphate;Enzyme N6-(S-propyldihydrolipoyl)lysine;2-Methyl-trans-aconitate 3.1.4 Metabolite keggid to kegg pathway library(MNet) keggid &lt;- c(&quot;C05984&quot;,&quot;C02494&quot;) ##### the output is the each metabolite related pathway keggpathway_result &lt;- keggid2pathway(keggid) head(keggpathway_result) ## # A tibble: 1 × 5 ## ENTRY NAME PATHWAY pathway_type V2 ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 C05984 2-Hydroxybutanoic acid;///2-Hydroxybutyrate;///2-Hyd… Propan… Carbohydrat… hsa0… 3.1.5 the pathway information result &lt;- pathwayinfo(&quot;hsa00630&quot;) result &lt;- pathwayinfo(&quot;Glyoxylate and dicarboxylate metabolism&quot;) result$gene_info[1:2,] ## type name kegg_pathwayid kegg_pathwayname ## 1 gene ACSS1 hsa00630 Glyoxylate and dicarboxylate metabolism ## 2 gene ACSS2 hsa00630 Glyoxylate and dicarboxylate metabolism ## kegg_category ## 1 Carbohydrate metabolism ## 2 Carbohydrate metabolism result$compound_info[1:2,] ## type name kegg_pathwayid kegg_pathwayname ## 1 metabolite C00007 hsa00630 Glyoxylate and dicarboxylate metabolism ## 2 metabolite C00011 hsa00630 Glyoxylate and dicarboxylate metabolism ## kegg_category ## 1 Carbohydrate metabolism ## 2 Carbohydrate metabolism 3.1.6 pathway name to pathway id pathwayid &lt;- pathway2pathwayid(&quot;Glycolysis / Gluconeogenesis&quot;) pathwayid ## PATHWAY pathwayid ## 1 Glycolysis / Gluconeogenesis hsa00010 3.2 Group-wise analyses 3.2.1 PCA plot PCA of the data ### the pca plot p_PCA &lt;- pPCA(meta_dat,group) ggplot2::ggsave(&quot;result_v0131/1.PCA_1.png&quot;,p_PCA$p1) ggplot2::ggsave(&quot;result_v0131/1.PCA_2.png&quot;,p_PCA$p2) ggplot2::ggsave(&quot;result_v0131/1.PCA_3.png&quot;,p_PCA$p3) 3.2.2 Differnetial metabolite analysis 3.2.2.1 using the function mlimma in R packages “MNet” diff_result &lt;- mlimma(meta_dat,group) 3.2.2.2 using the function DM in R packages “MNet” diff_result &lt;- DM(2**meta_dat,group) dev.off() write.table(diff_result,&quot;result_v0131/DM_result.txt&quot;,quote=F,row.names=F,sep=&quot;\\t&quot;) ## filter the differential metabolites by default fold change &gt;1.5 or &lt; 1/1.5 ,fdr &lt; 0.05 and VIP&gt;1 diff_result_filter &lt;- diff_result %&gt;% dplyr::filter(fold_change &gt;1.3 | fold_change &lt; 1/1.3) %&gt;% dplyr::filter(fdr_wilcox&lt;0.1) %&gt;% dplyr::filter(vip&gt;0.8) utils::write.table(diff_result,&quot;result_v0131/2.all_TumorvsNormal.txt&quot;,quote=F,row.names=F,sep=&quot;\\t&quot;) utils::write.table(diff_result_filter,&quot;result_v0131/2.diff_TumorvsNormal.txt&quot;,quote=F,row.names=F,sep=&quot;\\t&quot;) 3.2.3 Differential metabolites’ volcano the volcano plot of metabolites using the function “pVolcano” in the package “MNet” p_volcano &lt;- pVolcano(diff_result,foldchange=1.5) #p_volcano #ggplot2::ggsave(&quot;result_v0131/3.volcano.pdf&quot;,p_volcano) ggplot2::ggsave(&quot;result_v0131/3.volcano.png&quot;,p_volcano) 3.2.4 Differential metabolites’ heatmap the heatmap plot of differentital metabolites using the function “pHeatmap” in R package “MNet” meta_dat_diff &lt;- meta_dat[rownames(meta_dat) %in% diff_result_filter$name,] p_heatmap &lt;- pHeatmap(meta_dat_diff,group,fontsize_row=5,fontsize_col=4,clustering_method=&quot;ward.D&quot;,clustering_distance_cols=&quot;correlation&quot;) ggplot2::ggsave(&quot;result_v0131/3.heatmap.png&quot;,p_heatmap,width=10,height=8) 3.2.5 Differential metabolites’ zscore the zscore plot of differentital metabolites using the function “pZscore” in R package “MNet” p_zscore &lt;- pZscore(meta_dat_diff,group) #p_zscore ggplot2::ggsave(&quot;result_v0131/3.z_score.png&quot;,p_zscore,width=3,height=8) 3.3 Feature selection 3.3.1 Boruta #group &lt;- rep(&quot;normal&quot;,length(names(meta_dat))) #group[grep(&quot;TUMOR&quot;,names(meta_dat))] &lt;- &quot;tumor&quot; meta_dat1 &lt;- t(meta_dat) %&gt;% as.data.frame() %&gt;% dplyr::mutate(group=group) result_ML_Boruta &lt;- ML_Boruta(meta_dat1) 3.3.2 Random Forest result_ML_RF &lt;- ML_RF(meta_dat1) result_ML_RF$p result_ML_RF$feature_result 3.3.3 XGBoost result_ML_xgboost &lt;- ML_xgboost(meta_dat1) result_ML_xgboost$p result_ML_xgboost$feature_result 3.3.4 LASSO result_ML_lasso &lt;- ML_alpha(meta_dat1,method=&quot;lasso&quot;) 3.3.5 elastic network result_ML_elastic &lt;- ML_alpha(meta_dat1,method=&quot;elastic&quot;) 3.4 Pathway analysis 3.4.1 pathview only metabolite kegg_id &lt;- c(&quot;C02494&quot;,&quot;C03665&quot;,&quot;C01546&quot;,&quot;C05984&quot;,&quot;C14088&quot;,&quot;C00587&quot;) value &lt;- c(-0.3824620,0.1823628,-1.1681486,0.5164899,1.6449798,-0.7340652) names(value) &lt;- kegg_id cpd.data &lt;- value gene_name &lt;- c(&quot;LDHA&quot;,&quot;BCKDHB&quot;,&quot;PCCA&quot;,&quot;ACSS1&quot;) gene_value &lt;- c(1,0.5,-1,-1) names(gene_value) &lt;- gene_name pPathview(cpd.data,outdir=&quot;result_v0131&quot;) 3.4.2 pathview metabolite and gene pPathview(cpd.data=cpd.data,gene.data=gene_value,outdir=&quot;result_v0131&quot;) 3.5 Clinical analysis 3.5.1 Time series of clinical the column contains the time, group, clinical index(such as ALT), low and high clinical_index[1:5,] time_series_ALT &lt;- pCliTS(clinical_index,&quot;ALT&quot;) ggsave(&quot;result_v0131/clinical_time_series.png&quot;,time_series_ALT) 3.5.2 Survival analysis names(aml)[3] =&quot;group&quot; p=survCli(aml) png(&quot;result_v0131/survival.png&quot;) p dev.off() 3.5.3 Metabolites’ survival plot metabolites &lt;- c(&quot;C03819&quot;,&quot;C02918&quot;,&quot;C03916&quot;) survMet(dat_surv,metabolites,cluster_method=&quot;mean&quot;,out_dir=&quot;result_v0131/survival/&quot;) 3.5.4 Cox analysis result &lt;- MetCox(dat_surv) write.table(result,&quot;result_v0131/clinical_cox.txt&quot;,quote=F,sep=&quot;\\t&quot;,row.names = F) "],["session-information.html", "Chapter 4 Session information", " Chapter 4 Session information sessionInfo() ## R version 4.2.1 (2022-06-23) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Catalina 10.15.6 ## ## Matrix products: default ## BLAS: /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib ## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib ## ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] survival_3.5-5 pathview_1.36.1 caret_6.0-94 lattice_0.21-8 ## [5] knitr_1.42 RColorBrewer_1.1-3 ggplot2_3.4.2 stringr_1.5.0 ## [9] dplyr_1.1.1 MNet_0.1.0 ## ## loaded via a namespace (and not attached): ## [1] utf8_1.2.3 tidyselect_1.2.0 RSQLite_2.3.1 ## [4] AnnotationDbi_1.58.0 htmlwidgets_1.6.2 grid_4.2.1 ## [7] ranger_0.15.1 pROC_1.18.0 devtools_2.4.5 ## [10] munsell_0.5.0 codetools_0.2-19 ragg_1.2.5 ## [13] xgboost_1.7.5.1 DT_0.27 MultiDataSet_1.24.0 ## [16] future_1.32.0 miniUI_0.1.1.1 withr_2.5.0 ## [19] colorspace_2.1-0 Biobase_2.56.0 Boruta_8.0.0 ## [22] highr_0.10 supraHex_1.34.0 rstudioapi_0.14 ## [25] stats4_4.2.1 ggsignif_0.6.4 listenv_0.9.0 ## [28] MatrixGenerics_1.8.1 labeling_0.4.2 KEGGgraph_1.56.0 ## [31] GenomeInfoDbData_1.2.8 KMsurv_0.1-5 bit64_4.0.5 ## [34] farver_2.1.1 pheatmap_1.0.12 rprojroot_2.0.3 ## [37] parallelly_1.35.0 vctrs_0.6.1 generics_0.1.3 ## [40] ipred_0.9-14 xfun_0.38 qqman_0.1.8 ## [43] timechange_0.2.0 randomForest_4.7-1.1 R6_2.5.1 ## [46] GenomeInfoDb_1.32.4 bitops_1.0-7 cachem_1.0.7 ## [49] DelayedArray_0.22.0 promises_1.2.0.1 scales_1.2.1 ## [52] nnet_7.3-18 gtable_0.3.3 globals_0.16.2 ## [55] processx_3.8.0 timeDate_4022.108 rlang_1.1.0 ## [58] calibrate_1.7.7 systemfonts_1.0.4 splines_4.2.1 ## [61] rstatix_0.7.2 ModelMetrics_1.2.2.2 ropls_1.28.2 ## [64] hexbin_1.28.3 broom_1.0.4 checkmate_2.1.0 ## [67] abind_1.4-5 BiocManager_1.30.20 yaml_2.3.7 ## [70] reshape2_1.4.4 backports_1.4.1 crosstalk_1.2.0 ## [73] httpuv_1.6.9 tools_4.2.1 lava_1.7.2.1 ## [76] usethis_2.1.6 bookdown_0.33 ellipsis_0.3.2 ## [79] jquerylib_0.1.4 proxy_0.4-27 BiocGenerics_0.42.0 ## [82] sessioninfo_1.2.2 MultiAssayExperiment_1.22.0 Rcpp_1.0.10 ## [85] plyr_1.8.8 zlibbioc_1.42.0 purrr_1.0.1 ## [88] RCurl_1.98-1.12 ps_1.7.4 prettyunits_1.1.1 ## [91] ggpubr_0.6.0 rpart_4.1.19 urlchecker_1.0.1 ## [94] zoo_1.8-11 S4Vectors_0.34.0 SummarizedExperiment_1.26.1 ## [97] ggrepel_0.9.3 cluster_2.1.4 fs_1.6.1 ## [100] magrittr_2.0.3 data.table_1.14.8 dnet_1.1.7 ## [103] survminer_0.4.9 matrixStats_0.63.0 pkgload_1.3.2 ## [106] hms_1.1.3 mime_0.12 evaluate_0.20 ## [109] xtable_1.8-4 XML_3.99-0.14 gridExtra_2.3 ## [112] IRanges_2.30.1 shape_1.4.6 compiler_4.2.1 ## [115] tibble_3.2.1 crayon_1.5.2 htmltools_0.5.5 ## [118] mgcv_1.8-42 later_1.3.0 tzdb_0.3.0 ## [121] tidyr_1.3.0 DBI_1.1.3 lubridate_1.9.2 ## [124] filesstrings_3.2.4 MASS_7.3-58.3 car_3.1-2 ## [127] Matrix_1.5-4 readr_2.1.4 permute_0.9-7 ## [130] cli_3.6.1 parallel_4.2.1 gower_1.0.1 ## [133] igraph_1.4.2 km.ci_0.5-6 GenomicRanges_1.48.0 ## [136] pkgconfig_2.0.3 recipes_1.0.5 foreach_1.5.2 ## [139] bslib_0.4.2 hardhat_1.3.0 XVector_0.36.0 ## [142] prodlim_2023.03.31 callr_3.7.3 digest_0.6.31 ## [145] vegan_2.6-4 graph_1.74.0 Biostrings_2.64.1 ## [148] rmarkdown_2.21 survMisc_0.5.6 curl_5.0.0 ## [151] shiny_1.7.4 lifecycle_1.0.3 nlme_3.1-162 ## [154] jsonlite_1.8.4 carData_3.0-5 desc_1.4.2 ## [157] limma_3.52.4 fansi_1.0.4 pillar_1.9.0 ## [160] KEGGREST_1.36.3 fastmap_1.1.1 httr_1.4.5 ## [163] pkgbuild_1.4.0 glue_1.6.2 remotes_2.4.2 ## [166] png_0.1-8 iterators_1.0.14 bit_4.0.5 ## [169] glmnet_4.1-7 Rgraphviz_2.40.0 class_7.3-21 ## [172] stringi_1.7.12 sass_0.4.5 profvis_0.3.7 ## [175] blob_1.2.4 textshaping_0.3.6 strex_1.6.0 ## [178] org.Hs.eg.db_3.15.0 memoise_2.0.1 e1071_1.7-13 ## [181] future.apply_1.10.0 ape_5.7-1 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
