<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Figure4 | MNet</title>
  <meta name="description" content="Chapter 7 Figure4 | MNet" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Figure4 | MNet" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Figure4 | MNet" />
  
  
  

<meta name="author" content="Tuantuan Gui, Xuan Liu and Hai Fang" />


<meta name="date" content="2024-02-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="figure1.html"/>
<link rel="next" href="session-information.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.30/datatables.js"></script>
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="libs/dt-ext-buttons-1.13.4/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-buttons-1.13.4/js/dataTables.buttons.min.js"></script>
<script src="libs/dt-ext-buttons-1.13.4/js/buttons.html5.min.js"></script>
<script src="libs/dt-ext-buttons-1.13.4/js/buttons.colVis.min.js"></script>
<script src="libs/dt-ext-buttons-1.13.4/js/buttons.print.min.js"></script>
<link href="libs/dt-ext-fixedcolumns-1.13.4/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedcolumns-1.13.4/js/dataTables.fixedColumns.min.js"></script>
<link href="libs/dt-plugin-searchhighlight-1.13.4/source.css" rel="stylesheet" />
<script src="libs/dt-plugin-searchhighlight-1.13.4/jquery.highlight.js"></script>
<script src="libs/dt-plugin-searchhighlight-1.13.4/source.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction &amp; Installation</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#overview-of-workflow"><i class="fa fa-check"></i><b>1.1</b> Overview of Workflow</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="database-construction.html"><a href="database-construction.html"><i class="fa fa-check"></i><b>2</b> Database construction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="database-construction.html"><a href="database-construction.html#kegg-pathways-metabolite-and-gene"><i class="fa fa-check"></i><b>2.1</b> KEGG pathway’s metabolite and gene</a></li>
<li class="chapter" data-level="2.2" data-path="database-construction.html"><a href="database-construction.html#kegg-metabolite-metabolite-pairs-and-metabolite-gene-pairs"><i class="fa fa-check"></i><b>2.2</b> KEGG metabolite-metabolite pairs and metabolite-gene pairs</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="database-construction.html"><a href="database-construction.html#keggs-reaction-and-compounds-download"><i class="fa fa-check"></i><b>2.2.1</b> KEGG’s reaction and compound’s download</a></li>
<li class="chapter" data-level="2.2.2" data-path="database-construction.html"><a href="database-construction.html#downloading-the-enzyme-and-its-corresponding-gene-information-from-the-htextand-extract-the-gene-and-the-enzymes-relationship"><i class="fa fa-check"></i><b>2.2.2</b> Downloading the enzyme and its corresponding gene information from the htext,and extract the gene and the enzyme’s relationship</a></li>
<li class="chapter" data-level="2.2.3" data-path="database-construction.html"><a href="database-construction.html#extracting-the-metabolite-gene-pairs-and-metabolite-metabolite-pairs"><i class="fa fa-check"></i><b>2.2.3</b> Extracting the metabolite-gene pairs and metabolite-metabolite pairs</a></li>
<li class="chapter" data-level="2.2.4" data-path="database-construction.html"><a href="database-construction.html#conclusion"><i class="fa fa-check"></i><b>2.2.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="database-construction.html"><a href="database-construction.html#graphite"><i class="fa fa-check"></i><b>2.3</b> Graphite</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="database-construction.html"><a href="database-construction.html#download-all-the-data-from-graphite"><i class="fa fa-check"></i><b>2.3.1</b> Download all the data from graphite</a></li>
<li class="chapter" data-level="2.3.2" data-path="database-construction.html"><a href="database-construction.html#download-the-information-of-metabolism-pathways"><i class="fa fa-check"></i><b>2.3.2</b> Download the information of metabolism pathways</a></li>
<li class="chapter" data-level="2.3.3" data-path="database-construction.html"><a href="database-construction.html#extract-the-data-of-metabolism"><i class="fa fa-check"></i><b>2.3.3</b> Extract the data of metabolism</a></li>
<li class="chapter" data-level="2.3.4" data-path="database-construction.html"><a href="database-construction.html#combine-the-data-from-database-kegg-wikipathway-reactome-smpdb-and-then-uniq-the-data"><i class="fa fa-check"></i><b>2.3.4</b> Combine the data from database kegg, wikipathway, reactome, smpdb and then uniq the data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="database-construction.html"><a href="database-construction.html#bigg"><i class="fa fa-check"></i><b>2.4</b> BiGG</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="database-construction.html"><a href="database-construction.html#down-all-the-models-in-the-bigg"><i class="fa fa-check"></i><b>2.4.1</b> Down all the models in the BiGG</a></li>
<li class="chapter" data-level="2.4.2" data-path="database-construction.html"><a href="database-construction.html#download-the-every-reaction"><i class="fa fa-check"></i><b>2.4.2</b> Download the every reaction</a></li>
<li class="chapter" data-level="2.4.3" data-path="database-construction.html"><a href="database-construction.html#exact-all-the-metabolites-names-in-every-model-in-bigg"><i class="fa fa-check"></i><b>2.4.3</b> Exact all the metabolites names in every model in BiGG</a></li>
<li class="chapter" data-level="2.4.4" data-path="database-construction.html"><a href="database-construction.html#the-r-script-that-change-the-metabolite-name-to-kegg-id-in-the-final-output"><i class="fa fa-check"></i><b>2.4.4</b> The R script that change the metabolite name to kegg id in the final output</a></li>
<li class="chapter" data-level="2.4.5" data-path="database-construction.html"><a href="database-construction.html#combine-the-data-from-bigg-and-graphite"><i class="fa fa-check"></i><b>2.4.5</b> Combine the data from BiGG and graphite</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="example-unique-analyses.html"><a href="example-unique-analyses.html"><i class="fa fa-check"></i><b>3</b> Example-unique analyses</a>
<ul>
<li class="chapter" data-level="3.1" data-path="example-unique-analyses.html"><a href="example-unique-analyses.html#loading-the-data"><i class="fa fa-check"></i><b>3.1</b> Loading the data</a></li>
<li class="chapter" data-level="3.2" data-path="example-unique-analyses.html"><a href="example-unique-analyses.html#pathway-enrichment-analysis"><i class="fa fa-check"></i><b>3.2</b> Pathway enrichment analysis</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="example-unique-analyses.html"><a href="example-unique-analyses.html#gene-pathway-enrichment"><i class="fa fa-check"></i><b>3.2.1</b> gene pathway enrichment</a></li>
<li class="chapter" data-level="3.2.2" data-path="example-unique-analyses.html"><a href="example-unique-analyses.html#metabolite-pathway-enrichment"><i class="fa fa-check"></i><b>3.2.2</b> metabolite pathway enrichment</a></li>
<li class="chapter" data-level="3.2.3" data-path="example-unique-analyses.html"><a href="example-unique-analyses.html#extended-pathway-enrichment"><i class="fa fa-check"></i><b>3.2.3</b> Extended pathway enrichment</a></li>
<li class="chapter" data-level="3.2.4" data-path="example-unique-analyses.html"><a href="example-unique-analyses.html#overview-of-pathway-enrichment-analysis"><i class="fa fa-check"></i><b>3.2.4</b> Overview of pathway enrichment analysis</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="example-unique-analyses.html"><a href="example-unique-analyses.html#pathway-differential-abundance-score"><i class="fa fa-check"></i><b>3.3</b> Pathway differential abundance score</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="example-unique-analyses.html"><a href="example-unique-analyses.html#gene-differential-abundance-score"><i class="fa fa-check"></i><b>3.3.1</b> gene differential abundance score</a></li>
<li class="chapter" data-level="3.3.2" data-path="example-unique-analyses.html"><a href="example-unique-analyses.html#metabolite-differential-abundance-score"><i class="fa fa-check"></i><b>3.3.2</b> metabolite differential abundance score</a></li>
<li class="chapter" data-level="3.3.3" data-path="example-unique-analyses.html"><a href="example-unique-analyses.html#extended-pathway-differential-abundance-score"><i class="fa fa-check"></i><b>3.3.3</b> Extended pathway differential abundance score</a></li>
<li class="chapter" data-level="3.3.4" data-path="example-unique-analyses.html"><a href="example-unique-analyses.html#overview-of-pathway-differential-abundance-score"><i class="fa fa-check"></i><b>3.3.4</b> Overview of pathway differential abundance score</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="example-unique-analyses.html"><a href="example-unique-analyses.html#esea-metabolite-set-enrichment-analysis"><i class="fa fa-check"></i><b>3.4</b> ESEA Metabolite Set Enrichment Analysis</a></li>
<li class="chapter" data-level="3.5" data-path="example-unique-analyses.html"><a href="example-unique-analyses.html#subnetwork"><i class="fa fa-check"></i><b>3.5</b> Subnetwork</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html"><i class="fa fa-check"></i><b>4</b> Example-rountine analyses</a>
<ul>
<li class="chapter" data-level="4.1" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#metabolite-and-kegg-name-change"><i class="fa fa-check"></i><b>4.1</b> Metabolite and kegg name change</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#metabolite-name-changed-to-refmet-name"><i class="fa fa-check"></i><b>4.1.1</b> Metabolite name changed to refmet name</a></li>
<li class="chapter" data-level="4.1.2" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#metabolite-name-changed-to-kegg-id"><i class="fa fa-check"></i><b>4.1.2</b> Metabolite name changed to kegg id</a></li>
<li class="chapter" data-level="4.1.3" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#metabolite-name-corresponding-to-kegg-pathway"><i class="fa fa-check"></i><b>4.1.3</b> Metabolite name corresponding to kegg pathway</a></li>
<li class="chapter" data-level="4.1.4" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#metabolite-keggid-to-kegg-pathway"><i class="fa fa-check"></i><b>4.1.4</b> Metabolite keggid to kegg pathway</a></li>
<li class="chapter" data-level="4.1.5" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#the-pathway-information"><i class="fa fa-check"></i><b>4.1.5</b> The pathway information</a></li>
<li class="chapter" data-level="4.1.6" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#pathway-name-to-pathway-id"><i class="fa fa-check"></i><b>4.1.6</b> Pathway name to pathway id</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#group-wise-analyses"><i class="fa fa-check"></i><b>4.2</b> Group-wise analyses</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#pca-plot"><i class="fa fa-check"></i><b>4.2.1</b> PCA plot</a></li>
<li class="chapter" data-level="4.2.2" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#differnetial-metabolite-analysis"><i class="fa fa-check"></i><b>4.2.2</b> Differnetial metabolite analysis</a></li>
<li class="chapter" data-level="4.2.3" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#differential-metabolites-volcano"><i class="fa fa-check"></i><b>4.2.3</b> Differential metabolites’ volcano</a></li>
<li class="chapter" data-level="4.2.4" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#differential-metabolites-heatmap"><i class="fa fa-check"></i><b>4.2.4</b> Differential metabolites’ heatmap</a></li>
<li class="chapter" data-level="4.2.5" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#differential-metabolites-zscore"><i class="fa fa-check"></i><b>4.2.5</b> Differential metabolites’ zscore</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#pathway-analysis"><i class="fa fa-check"></i><b>4.3</b> Pathway analysis</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#pathview-only-metabolite"><i class="fa fa-check"></i><b>4.3.1</b> Pathview only metabolite</a></li>
<li class="chapter" data-level="4.3.2" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#pathview-metabolite-and-gene"><i class="fa fa-check"></i><b>4.3.2</b> Pathview metabolite and gene</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#clinical-analysis"><i class="fa fa-check"></i><b>4.4</b> Clinical analysis</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#time-series-of-clinical"><i class="fa fa-check"></i><b>4.4.1</b> Time series of clinical</a></li>
<li class="chapter" data-level="4.4.2" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#survival-analysis"><i class="fa fa-check"></i><b>4.4.2</b> Survival analysis</a></li>
<li class="chapter" data-level="4.4.3" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#metabolites-survival-plot"><i class="fa fa-check"></i><b>4.4.3</b> Metabolites’ survival plot</a></li>
<li class="chapter" data-level="4.4.4" data-path="example-rountine-analyses.html"><a href="example-rountine-analyses.html#cox-analysis"><i class="fa fa-check"></i><b>4.4.4</b> Cox analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>5</b> Shiny</a>
<ul>
<li class="chapter" data-level="5.1" data-path="shiny.html"><a href="shiny.html#tencent-log"><i class="fa fa-check"></i><b>5.1</b> Tencent log</a></li>
<li class="chapter" data-level="5.2" data-path="shiny.html"><a href="shiny.html#shiny-app-log"><i class="fa fa-check"></i><b>5.2</b> Shiny app log</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="figure1.html"><a href="figure1.html"><i class="fa fa-check"></i><b>6</b> Figure1</a>
<ul>
<li class="chapter" data-level="6.1" data-path="figure1.html"><a href="figure1.html#a"><i class="fa fa-check"></i><b>6.1</b> 1.1 (A)</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="figure1.html"><a href="figure1.html#batch-removal"><i class="fa fa-check"></i><b>6.1.1</b> Batch removal</a></li>
<li class="chapter" data-level="6.1.2" data-path="figure1.html"><a href="figure1.html#metabolite-information"><i class="fa fa-check"></i><b>6.1.2</b> Metabolite information</a></li>
<li class="chapter" data-level="6.1.3" data-path="figure1.html"><a href="figure1.html#metabolic-pathway-information"><i class="fa fa-check"></i><b>6.1.3</b> Metabolic pathway information</a></li>
<li class="chapter" data-level="6.1.4" data-path="figure1.html"><a href="figure1.html#metabolite-and-metabolic-pathway-annotation"><i class="fa fa-check"></i><b>6.1.4</b> Metabolite and metabolic pathway annotation</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="figure1.html"><a href="figure1.html#b"><i class="fa fa-check"></i><b>6.2</b> 1.2 (B)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="figure1.html"><a href="figure1.html#clinical-and-metabolite-analysis"><i class="fa fa-check"></i><b>6.2.1</b> Clinical and metabolite analysis</a></li>
<li class="chapter" data-level="6.2.2" data-path="figure1.html"><a href="figure1.html#time-series-analysis"><i class="fa fa-check"></i><b>6.2.2</b> Time series analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="figure1.html"><a href="figure1.html#c"><i class="fa fa-check"></i><b>6.3</b> 1.3 (C)</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="figure1.html"><a href="figure1.html#dimension-reduction-visualization"><i class="fa fa-check"></i><b>6.3.1</b> Dimension reduction &amp; Visualization</a></li>
<li class="chapter" data-level="6.3.2" data-path="figure1.html"><a href="figure1.html#differential-metabolites-visualization"><i class="fa fa-check"></i><b>6.3.2</b> Differential metabolites visualization</a></li>
<li class="chapter" data-level="6.3.3" data-path="figure1.html"><a href="figure1.html#pathway-enrichment-analyses"><i class="fa fa-check"></i><b>6.3.3</b> Pathway enrichment analyses</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="figure1.html"><a href="figure1.html#d"><i class="fa fa-check"></i><b>6.4</b> 1.4 (D)</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="figure1.html"><a href="figure1.html#extended-pathway-enrichment-analysis-epea"><i class="fa fa-check"></i><b>6.4.1</b> Extended pathway enrichment analysis (EPEA)</a></li>
<li class="chapter" data-level="6.4.2" data-path="figure1.html"><a href="figure1.html#extended-differential-abundance-eda-score"><i class="fa fa-check"></i><b>6.4.2</b> Extended differential abundance (EDA) score</a></li>
<li class="chapter" data-level="6.4.3" data-path="figure1.html"><a href="figure1.html#extended-data-set-enrichment-analysis-esea"><i class="fa fa-check"></i><b>6.4.3</b> Extended data set enrichment analysis (ESEA)</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="figure1.html"><a href="figure1.html#e"><i class="fa fa-check"></i><b>6.5</b> 1.5 (E)</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="figure1.html"><a href="figure1.html#dbmnet-database"><i class="fa fa-check"></i><b>6.5.1</b> dbMNet database</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="figure4.html"><a href="figure4.html"><i class="fa fa-check"></i><b>7</b> Figure4</a>
<ul>
<li class="chapter" data-level="7.1" data-path="figure4.html"><a href="figure4.html#load-data"><i class="fa fa-check"></i><b>7.1</b> Load data</a></li>
<li class="chapter" data-level="7.2" data-path="figure4.html"><a href="figure4.html#mlimma-analysis"><i class="fa fa-check"></i><b>7.2</b> mlimma analysis</a></li>
<li class="chapter" data-level="7.3" data-path="figure4.html"><a href="figure4.html#epe-analysis"><i class="fa fa-check"></i><b>7.3</b> EPE analysis</a></li>
<li class="chapter" data-level="7.4" data-path="figure4.html"><a href="figure4.html#eda-analysis"><i class="fa fa-check"></i><b>7.4</b> EDA analysis</a></li>
<li class="chapter" data-level="7.5" data-path="figure4.html"><a href="figure4.html#esea-analysis"><i class="fa fa-check"></i><b>7.5</b> ESEA analysis</a></li>
<li class="chapter" data-level="7.6" data-path="figure4.html"><a href="figure4.html#aml-epe-analysis"><i class="fa fa-check"></i><b>7.6</b> AML EPE analysis</a></li>
<li class="chapter" data-level="7.7" data-path="figure4.html"><a href="figure4.html#volcano-plot-1"><i class="fa fa-check"></i><b>7.7</b> Volcano plot</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="figure4.html"><a href="figure4.html#differential-metabolites-and-genes"><i class="fa fa-check"></i><b>7.7.1</b> Differential metabolites and genes</a></li>
<li class="chapter" data-level="7.7.2" data-path="figure4.html"><a href="figure4.html#all"><i class="fa fa-check"></i><b>7.7.2</b> ALL</a></li>
<li class="chapter" data-level="7.7.3" data-path="figure4.html"><a href="figure4.html#aml"><i class="fa fa-check"></i><b>7.7.3</b> AML</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="figure4.html"><a href="figure4.html#heatmap-1"><i class="fa fa-check"></i><b>7.8</b> Heatmap</a></li>
<li class="chapter" data-level="7.9" data-path="figure4.html"><a href="figure4.html#subnetwork-1"><i class="fa fa-check"></i><b>7.9</b> Subnetwork</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="session-information.html"><a href="session-information.html"><i class="fa fa-check"></i><b>8</b> Session information</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MNet</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="figure4" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Figure4<a href="figure4.html#figure4" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="load-data" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Load data<a href="figure4.html#load-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="figure4.html#cb93-1" tabindex="-1"></a><span class="do">## load metabolite data</span></span>
<span id="cb93-2"><a href="figure4.html#cb93-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb93-3"><a href="figure4.html#cb93-3" tabindex="-1"></a></span>
<span id="cb93-4"><a href="figure4.html#cb93-4" tabindex="-1"></a>sample <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;/Users/guituantuan/Desktop/projects/CCLE/Cell_lines_annotations_20181226.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-5"><a href="figure4.html#cb93-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb93-6"><a href="figure4.html#cb93-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Site_Primary <span class="sc">==</span> <span class="st">&quot;haematopoietic_and_lymphoid_tissue&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-7"><a href="figure4.html#cb93-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Hist_Subtype1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;acute_myeloid_leukaemia&quot;</span>,<span class="st">&quot;acute_lymphoblastic_B_cell_leukaemia&quot;</span>,<span class="st">&quot;acute_lymphoblastic_T_cell_leukaemia&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb93-8"><a href="figure4.html#cb93-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(CCLE_ID,Hist_Subtype1) <span class="sc">%&gt;%</span></span>
<span id="cb93-9"><a href="figure4.html#cb93-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">group=</span><span class="fu">ifelse</span>(Hist_Subtype1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;acute_lymphoblastic_B_cell_leukaemia&quot;</span>,<span class="st">&quot;acute_lymphoblastic_T_cell_leukaemia&quot;</span>),</span>
<span id="cb93-10"><a href="figure4.html#cb93-10" tabindex="-1"></a>                             <span class="st">&quot;acute_lymphoblastic_leukaemia&quot;</span>,Hist_Subtype1))</span>
<span id="cb93-11"><a href="figure4.html#cb93-11" tabindex="-1"></a></span>
<span id="cb93-12"><a href="figure4.html#cb93-12" tabindex="-1"></a></span>
<span id="cb93-13"><a href="figure4.html#cb93-13" tabindex="-1"></a>dat_met <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;/Users/guituantuan/Desktop/projects/CCLE/CCLE_metabolomics_20190502.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-14"><a href="figure4.html#cb93-14" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb93-15"><a href="figure4.html#cb93-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>DepMap_ID) <span class="sc">%&gt;%</span></span>
<span id="cb93-16"><a href="figure4.html#cb93-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(CCLE_ID <span class="sc">%in%</span> sample<span class="sc">$</span>CCLE_ID)</span>
<span id="cb93-17"><a href="figure4.html#cb93-17" tabindex="-1"></a></span>
<span id="cb93-18"><a href="figure4.html#cb93-18" tabindex="-1"></a><span class="fu">write.table</span>(dat_met,<span class="st">&quot;/Users/guituantuan/Desktop/R_packages/MNet_CCLE/dat_met.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb93-19"><a href="figure4.html#cb93-19" tabindex="-1"></a><span class="fu">write.table</span>(sample,<span class="st">&quot;/Users/guituantuan/Desktop/R_packages/MNet_CCLE/sample_met.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb93-20"><a href="figure4.html#cb93-20" tabindex="-1"></a></span>
<span id="cb93-21"><a href="figure4.html#cb93-21" tabindex="-1"></a><span class="do">## load gene data</span></span>
<span id="cb93-22"><a href="figure4.html#cb93-22" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb93-23"><a href="figure4.html#cb93-23" tabindex="-1"></a></span>
<span id="cb93-24"><a href="figure4.html#cb93-24" tabindex="-1"></a>sample <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;/Users/guituantuan/Desktop/projects/CCLE/Cell_lines_annotations_20181226.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-25"><a href="figure4.html#cb93-25" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb93-26"><a href="figure4.html#cb93-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Site_Primary <span class="sc">==</span> <span class="st">&quot;haematopoietic_and_lymphoid_tissue&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-27"><a href="figure4.html#cb93-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Hist_Subtype1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;acute_myeloid_leukaemia&quot;</span>,<span class="st">&quot;acute_lymphoblastic_B_cell_leukaemia&quot;</span>,<span class="st">&quot;acute_lymphoblastic_T_cell_leukaemia&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb93-28"><a href="figure4.html#cb93-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(CCLE_ID,Hist_Subtype1) <span class="sc">%&gt;%</span></span>
<span id="cb93-29"><a href="figure4.html#cb93-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">group=</span><span class="fu">ifelse</span>(Hist_Subtype1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;acute_lymphoblastic_B_cell_leukaemia&quot;</span>,<span class="st">&quot;acute_lymphoblastic_T_cell_leukaemia&quot;</span>),</span>
<span id="cb93-30"><a href="figure4.html#cb93-30" tabindex="-1"></a>                             <span class="st">&quot;acute_lymphoblastic_leukaemia&quot;</span>,Hist_Subtype1))</span>
<span id="cb93-31"><a href="figure4.html#cb93-31" tabindex="-1"></a></span>
<span id="cb93-32"><a href="figure4.html#cb93-32" tabindex="-1"></a>protein <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;~/Desktop/projects/RNA-seq/ALL/result_v0612/1_expression/gene.id.v38.txt&quot;</span>,<span class="at">header=</span>F) <span class="sc">%&gt;%</span></span>
<span id="cb93-33"><a href="figure4.html#cb93-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(V2 <span class="sc">==</span> <span class="st">&quot;protein_coding&quot;</span>)</span>
<span id="cb93-34"><a href="figure4.html#cb93-34" tabindex="-1"></a>dat_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;/Users/guituantuan/Desktop/projects/CCLE/CCLE_RNAseq_genes_rpkm_20180929.gct&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-35"><a href="figure4.html#cb93-35" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb93-36"><a href="figure4.html#cb93-36" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Description <span class="sc">%in%</span> protein<span class="sc">$</span>V3)</span>
<span id="cb93-37"><a href="figure4.html#cb93-37" tabindex="-1"></a></span>
<span id="cb93-38"><a href="figure4.html#cb93-38" tabindex="-1"></a>sample_overlap <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">names</span>(dat_gene),sample<span class="sc">$</span>CCLE_ID)</span>
<span id="cb93-39"><a href="figure4.html#cb93-39" tabindex="-1"></a></span>
<span id="cb93-40"><a href="figure4.html#cb93-40" tabindex="-1"></a>dat_gene_result <span class="ot">&lt;-</span> dat_gene <span class="sc">%&gt;%</span></span>
<span id="cb93-41"><a href="figure4.html#cb93-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Description,<span class="fu">all_of</span>(sample_overlap))</span>
<span id="cb93-42"><a href="figure4.html#cb93-42" tabindex="-1"></a></span>
<span id="cb93-43"><a href="figure4.html#cb93-43" tabindex="-1"></a><span class="fu">write.table</span>(dat_gene_result,<span class="st">&quot;/Users/guituantuan/Desktop/R_packages/MNet_CCLE/dat_gene.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
<div id="mlimma-analysis" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> mlimma analysis<a href="figure4.html#mlimma-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="figure4.html#cb94-1" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">&quot;result/figure4&quot;</span>)</span>
<span id="cb94-2"><a href="figure4.html#cb94-2" tabindex="-1"></a></span>
<span id="cb94-3"><a href="figure4.html#cb94-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb94-4"><a href="figure4.html#cb94-4" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb94-5"><a href="figure4.html#cb94-5" tabindex="-1"></a></span>
<span id="cb94-6"><a href="figure4.html#cb94-6" tabindex="-1"></a>sample <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/sample_met.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-7"><a href="figure4.html#cb94-7" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb94-8"><a href="figure4.html#cb94-8" tabindex="-1"></a></span>
<span id="cb94-9"><a href="figure4.html#cb94-9" tabindex="-1"></a>dat_met <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/dat_met.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-10"><a href="figure4.html#cb94-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb94-11"><a href="figure4.html#cb94-11" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;CCLE_ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-12"><a href="figure4.html#cb94-12" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb94-13"><a href="figure4.html#cb94-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb94-14"><a href="figure4.html#cb94-14" tabindex="-1"></a>dat_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/dat_gene.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-15"><a href="figure4.html#cb94-15" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb94-16"><a href="figure4.html#cb94-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(Description,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb94-17"><a href="figure4.html#cb94-17" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Description&quot;</span>)</span>
<span id="cb94-18"><a href="figure4.html#cb94-18" tabindex="-1"></a></span>
<span id="cb94-19"><a href="figure4.html#cb94-19" tabindex="-1"></a>sample_overlap <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">names</span>(dat_met),<span class="fu">names</span>(dat_gene))</span>
<span id="cb94-20"><a href="figure4.html#cb94-20" tabindex="-1"></a><span class="fu">length</span>(sample_overlap)</span>
<span id="cb94-21"><a href="figure4.html#cb94-21" tabindex="-1"></a></span>
<span id="cb94-22"><a href="figure4.html#cb94-22" tabindex="-1"></a>dat_met_filter <span class="ot">&lt;-</span> dat_met <span class="sc">%&gt;%</span></span>
<span id="cb94-23"><a href="figure4.html#cb94-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(sample_overlap))</span>
<span id="cb94-24"><a href="figure4.html#cb94-24" tabindex="-1"></a></span>
<span id="cb94-25"><a href="figure4.html#cb94-25" tabindex="-1"></a>dat_gene_filter <span class="ot">&lt;-</span> dat_gene <span class="sc">%&gt;%</span></span>
<span id="cb94-26"><a href="figure4.html#cb94-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(sample_overlap))</span>
<span id="cb94-27"><a href="figure4.html#cb94-27" tabindex="-1"></a></span>
<span id="cb94-28"><a href="figure4.html#cb94-28" tabindex="-1"></a><span class="fu">write.table</span>(dat_gene_filter,<span class="st">&quot;result/figure4/0.data_gene.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb94-29"><a href="figure4.html#cb94-29" tabindex="-1"></a><span class="fu">write.table</span>(dat_met_filter,<span class="st">&quot;result/figure4/0.data_meta.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb94-30"><a href="figure4.html#cb94-30" tabindex="-1"></a></span>
<span id="cb94-31"><a href="figure4.html#cb94-31" tabindex="-1"></a>sample_filter <span class="ot">&lt;-</span> sample <span class="sc">%&gt;%</span></span>
<span id="cb94-32"><a href="figure4.html#cb94-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(CCLE_ID <span class="sc">%in%</span> sample_overlap) <span class="sc">%&gt;%</span></span>
<span id="cb94-33"><a href="figure4.html#cb94-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(CCLE_ID,sample_overlap))</span>
<span id="cb94-34"><a href="figure4.html#cb94-34" tabindex="-1"></a><span class="fu">write.table</span>(sample_filter,<span class="st">&quot;result/figure4/0.sample.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb94-35"><a href="figure4.html#cb94-35" tabindex="-1"></a></span>
<span id="cb94-36"><a href="figure4.html#cb94-36" tabindex="-1"></a>group <span class="ot">&lt;-</span> sample_filter<span class="sc">$</span>group</span>
<span id="cb94-37"><a href="figure4.html#cb94-37" tabindex="-1"></a>group[group<span class="sc">==</span><span class="st">&quot;acute_myeloid_leukaemia&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;tumor&quot;</span></span>
<span id="cb94-38"><a href="figure4.html#cb94-38" tabindex="-1"></a>group[group<span class="sc">==</span><span class="st">&quot;acute_lymphoblastic_leukaemia&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;normal&quot;</span></span>
<span id="cb94-39"><a href="figure4.html#cb94-39" tabindex="-1"></a></span>
<span id="cb94-40"><a href="figure4.html#cb94-40" tabindex="-1"></a>diff_met <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(dat_met_filter,group)</span>
<span id="cb94-41"><a href="figure4.html#cb94-41" tabindex="-1"></a>diff_gene <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(<span class="fu">log2</span>(dat_gene_filter<span class="sc">+</span><span class="dv">1</span>),group)</span>
<span id="cb94-42"><a href="figure4.html#cb94-42" tabindex="-1"></a><span class="fu">write.table</span>(diff_met,<span class="st">&quot;result/figure4/diff_met.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb94-43"><a href="figure4.html#cb94-43" tabindex="-1"></a><span class="fu">write.table</span>(diff_gene,<span class="st">&quot;result/figure4/diff_gene.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
<div id="epe-analysis" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> EPE analysis<a href="figure4.html#epe-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="figure4.html#cb95-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb95-2"><a href="figure4.html#cb95-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb95-3"><a href="figure4.html#cb95-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb95-4"><a href="figure4.html#cb95-4" tabindex="-1"></a></span>
<span id="cb95-5"><a href="figure4.html#cb95-5" tabindex="-1"></a>all_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/diff_gene.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-6"><a href="figure4.html#cb95-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb95-7"><a href="figure4.html#cb95-7" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/diff_met.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-8"><a href="figure4.html#cb95-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb95-9"><a href="figure4.html#cb95-9" tabindex="-1"></a></span>
<span id="cb95-10"><a href="figure4.html#cb95-10" tabindex="-1"></a>kid <span class="ot">&lt;-</span> <span class="fu">name2keggid</span>(all_meta<span class="sc">$</span>name)</span>
<span id="cb95-11"><a href="figure4.html#cb95-11" tabindex="-1"></a>kid1 <span class="ot">&lt;-</span> kid <span class="sc">%&gt;%</span></span>
<span id="cb95-12"><a href="figure4.html#cb95-12" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_rows</span>(KEGG_id,<span class="at">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb95-13"><a href="figure4.html#cb95-13" tabindex="-1"></a></span>
<span id="cb95-14"><a href="figure4.html#cb95-14" tabindex="-1"></a>all_meta1 <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span></span>
<span id="cb95-15"><a href="figure4.html#cb95-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kid1,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;Name&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb95-16"><a href="figure4.html#cb95-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(KEGG_id)) <span class="sc">%&gt;%</span></span>
<span id="cb95-17"><a href="figure4.html#cb95-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(P.Value) <span class="sc">%&gt;%</span></span>
<span id="cb95-18"><a href="figure4.html#cb95-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(KEGG_id,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb95-19"><a href="figure4.html#cb95-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb95-20"><a href="figure4.html#cb95-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;KEGG_id&quot;</span>)</span>
<span id="cb95-21"><a href="figure4.html#cb95-21" tabindex="-1"></a></span>
<span id="cb95-22"><a href="figure4.html#cb95-22" tabindex="-1"></a></span>
<span id="cb95-23"><a href="figure4.html#cb95-23" tabindex="-1"></a><span class="do">## gene</span></span>
<span id="cb95-24"><a href="figure4.html#cb95-24" tabindex="-1"></a>diff_gene_increase <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb95-25"><a href="figure4.html#cb95-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-26"><a href="figure4.html#cb95-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb95-27"><a href="figure4.html#cb95-27" tabindex="-1"></a></span>
<span id="cb95-28"><a href="figure4.html#cb95-28" tabindex="-1"></a>result_gene_increase <span class="ot">&lt;-</span> <span class="fu">PathwayAnalysis</span>(diff_gene_increase<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">0.05</span>)</span>
<span id="cb95-29"><a href="figure4.html#cb95-29" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/01.gene_increase.pdf&quot;</span>,result_gene_increase<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-30"><a href="figure4.html#cb95-30" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/01.gene_increase.png&quot;</span>,result_gene_increase<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-31"><a href="figure4.html#cb95-31" tabindex="-1"></a><span class="fu">write.table</span>(result_gene_increase<span class="sc">$</span>output,<span class="st">&quot;result/figure4/01.gene_increase.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb95-32"><a href="figure4.html#cb95-32" tabindex="-1"></a></span>
<span id="cb95-33"><a href="figure4.html#cb95-33" tabindex="-1"></a>diff_gene_decrease <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb95-34"><a href="figure4.html#cb95-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-35"><a href="figure4.html#cb95-35" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb95-36"><a href="figure4.html#cb95-36" tabindex="-1"></a></span>
<span id="cb95-37"><a href="figure4.html#cb95-37" tabindex="-1"></a>result_gene_decrease <span class="ot">&lt;-</span> <span class="fu">PathwayAnalysis</span>(diff_gene_decrease<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">0.05</span>)</span>
<span id="cb95-38"><a href="figure4.html#cb95-38" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/01.gene_decrease.pdf&quot;</span>,result_gene_decrease<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-39"><a href="figure4.html#cb95-39" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/01.gene_decrease.png&quot;</span>,result_gene_decrease<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-40"><a href="figure4.html#cb95-40" tabindex="-1"></a><span class="fu">write.table</span>(result_gene_decrease<span class="sc">$</span>output,<span class="st">&quot;result/figure4/01.gene_decrease.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb95-41"><a href="figure4.html#cb95-41" tabindex="-1"></a></span>
<span id="cb95-42"><a href="figure4.html#cb95-42" tabindex="-1"></a></span>
<span id="cb95-43"><a href="figure4.html#cb95-43" tabindex="-1"></a><span class="do">## metabolite</span></span>
<span id="cb95-44"><a href="figure4.html#cb95-44" tabindex="-1"></a><span class="do">## filter the increase differential genes and metabolites</span></span>
<span id="cb95-45"><a href="figure4.html#cb95-45" tabindex="-1"></a>diff_meta_increase <span class="ot">&lt;-</span> all_meta1 <span class="sc">%&gt;%</span></span>
<span id="cb95-46"><a href="figure4.html#cb95-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-47"><a href="figure4.html#cb95-47" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb95-48"><a href="figure4.html#cb95-48" tabindex="-1"></a></span>
<span id="cb95-49"><a href="figure4.html#cb95-49" tabindex="-1"></a>result_meta_increase <span class="ot">&lt;-</span> <span class="fu">PathwayAnalysis</span>(diff_meta_increase<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">0.05</span>)</span>
<span id="cb95-50"><a href="figure4.html#cb95-50" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/02.meta_increase.pdf&quot;</span>,result_meta_increase<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-51"><a href="figure4.html#cb95-51" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/02.meta_increase.png&quot;</span>,result_meta_increase<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-52"><a href="figure4.html#cb95-52" tabindex="-1"></a><span class="fu">write.table</span>(result_meta_increase<span class="sc">$</span>output,<span class="st">&quot;result/figure4/02.meta_increase.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb95-53"><a href="figure4.html#cb95-53" tabindex="-1"></a></span>
<span id="cb95-54"><a href="figure4.html#cb95-54" tabindex="-1"></a>diff_meta_decrease <span class="ot">&lt;-</span> all_meta1 <span class="sc">%&gt;%</span></span>
<span id="cb95-55"><a href="figure4.html#cb95-55" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-56"><a href="figure4.html#cb95-56" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value  <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb95-57"><a href="figure4.html#cb95-57" tabindex="-1"></a></span>
<span id="cb95-58"><a href="figure4.html#cb95-58" tabindex="-1"></a>result_meta_decrease <span class="ot">&lt;-</span> <span class="fu">PathwayAnalysis</span>(diff_meta_decrease<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">0.05</span>)</span>
<span id="cb95-59"><a href="figure4.html#cb95-59" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/02.meta_decrease.pdf&quot;</span>,result_meta_decrease<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-60"><a href="figure4.html#cb95-60" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/02.meta_decrease.png&quot;</span>,result_meta_decrease<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-61"><a href="figure4.html#cb95-61" tabindex="-1"></a><span class="fu">write.table</span>(result_meta_decrease<span class="sc">$</span>output,<span class="st">&quot;result/figure4/02.meta_decrease.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb95-62"><a href="figure4.html#cb95-62" tabindex="-1"></a></span>
<span id="cb95-63"><a href="figure4.html#cb95-63" tabindex="-1"></a><span class="do">## gene and metabolite</span></span>
<span id="cb95-64"><a href="figure4.html#cb95-64" tabindex="-1"></a>diff_increase <span class="ot">&lt;-</span> <span class="fu">rbind</span>(diff_gene_increase,diff_meta_increase)</span>
<span id="cb95-65"><a href="figure4.html#cb95-65" tabindex="-1"></a>result_all_increase <span class="ot">&lt;-</span> <span class="fu">PathwayAnalysis</span>(diff_increase<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">0.05</span>)</span>
<span id="cb95-66"><a href="figure4.html#cb95-66" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/03.all_increase.pdf&quot;</span>,result_all_increase<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-67"><a href="figure4.html#cb95-67" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/03.all_increase.png&quot;</span>,result_all_increase<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-68"><a href="figure4.html#cb95-68" tabindex="-1"></a><span class="fu">write.table</span>(result_all_increase<span class="sc">$</span>output,<span class="st">&quot;result/figure4/03.all_increase.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb95-69"><a href="figure4.html#cb95-69" tabindex="-1"></a></span>
<span id="cb95-70"><a href="figure4.html#cb95-70" tabindex="-1"></a>diff_decrease <span class="ot">&lt;-</span> <span class="fu">rbind</span>(diff_gene_decrease,diff_meta_decrease)</span>
<span id="cb95-71"><a href="figure4.html#cb95-71" tabindex="-1"></a>result_all_decrease <span class="ot">&lt;-</span> <span class="fu">PathwayAnalysis</span>(diff_decrease<span class="sc">$</span>name,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">p_cutoff=</span><span class="fl">0.05</span>)</span>
<span id="cb95-72"><a href="figure4.html#cb95-72" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/03.all_decrease.pdf&quot;</span>,result_all_decrease<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-73"><a href="figure4.html#cb95-73" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/03.all_decrease.png&quot;</span>,result_all_decrease<span class="sc">$</span>p_barplot,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb95-74"><a href="figure4.html#cb95-74" tabindex="-1"></a><span class="fu">write.table</span>(result_all_decrease<span class="sc">$</span>output,<span class="st">&quot;result/figure4/03.all_decrease.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names =</span> F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>Metabolite</p>
<p><img src="result/figure4/02.meta_increase.png" width="50%" /><img src="result/figure4/02.meta_decrease.png" width="50%" /></p>
<p>Gene</p>
<p><img src="result/figure4/01.gene_increase.png" width="50%" /><img src="result/figure4/01.gene_decrease.png" width="50%" /></p>
<p>Metabolite + Gene</p>
<p><img src="result/figure4/03.all_increase.png" width="50%" /><img src="result/figure4/03.all_decrease.png" width="50%" /></p>
</div>
<div id="eda-analysis" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> EDA analysis<a href="figure4.html#eda-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="figure4.html#cb96-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb96-2"><a href="figure4.html#cb96-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb96-3"><a href="figure4.html#cb96-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb96-4"><a href="figure4.html#cb96-4" tabindex="-1"></a></span>
<span id="cb96-5"><a href="figure4.html#cb96-5" tabindex="-1"></a>all_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/diff_gene.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-6"><a href="figure4.html#cb96-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb96-7"><a href="figure4.html#cb96-7" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/diff_met.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-8"><a href="figure4.html#cb96-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb96-9"><a href="figure4.html#cb96-9" tabindex="-1"></a></span>
<span id="cb96-10"><a href="figure4.html#cb96-10" tabindex="-1"></a>kid <span class="ot">&lt;-</span> <span class="fu">name2keggid</span>(all_meta<span class="sc">$</span>name)</span>
<span id="cb96-11"><a href="figure4.html#cb96-11" tabindex="-1"></a>kid1 <span class="ot">&lt;-</span> kid <span class="sc">%&gt;%</span></span>
<span id="cb96-12"><a href="figure4.html#cb96-12" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_rows</span>(KEGG_id,<span class="at">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb96-13"><a href="figure4.html#cb96-13" tabindex="-1"></a></span>
<span id="cb96-14"><a href="figure4.html#cb96-14" tabindex="-1"></a>all_meta1 <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span></span>
<span id="cb96-15"><a href="figure4.html#cb96-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kid1,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;Name&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb96-16"><a href="figure4.html#cb96-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(KEGG_id)) <span class="sc">%&gt;%</span></span>
<span id="cb96-17"><a href="figure4.html#cb96-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(P.Value) <span class="sc">%&gt;%</span></span>
<span id="cb96-18"><a href="figure4.html#cb96-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(KEGG_id,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb96-19"><a href="figure4.html#cb96-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb96-20"><a href="figure4.html#cb96-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;KEGG_id&quot;</span>)</span>
<span id="cb96-21"><a href="figure4.html#cb96-21" tabindex="-1"></a></span>
<span id="cb96-22"><a href="figure4.html#cb96-22" tabindex="-1"></a></span>
<span id="cb96-23"><a href="figure4.html#cb96-23" tabindex="-1"></a>diff_gene_increase <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb96-24"><a href="figure4.html#cb96-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-25"><a href="figure4.html#cb96-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span>
<span id="cb96-26"><a href="figure4.html#cb96-26" tabindex="-1"></a></span>
<span id="cb96-27"><a href="figure4.html#cb96-27" tabindex="-1"></a>diff_gene_decrease <span class="ot">&lt;-</span> all_gene <span class="sc">%&gt;%</span></span>
<span id="cb96-28"><a href="figure4.html#cb96-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-29"><a href="figure4.html#cb96-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(adj.P.Val <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span>
<span id="cb96-30"><a href="figure4.html#cb96-30" tabindex="-1"></a></span>
<span id="cb96-31"><a href="figure4.html#cb96-31" tabindex="-1"></a>DAscore_gene <span class="ot">&lt;-</span> <span class="fu">DAscore</span>(diff_gene_increase<span class="sc">$</span>name,diff_gene_decrease<span class="sc">$</span>name,all_gene<span class="sc">$</span>name,</span>
<span id="cb96-32"><a href="figure4.html#cb96-32" tabindex="-1"></a>                        <span class="at">min_measured_num =</span> <span class="dv">10</span>,<span class="at">out=</span><span class="st">&quot;gene&quot;</span>,<span class="at">sort_plot=</span><span class="st">&quot;category&quot;</span>)</span>
<span id="cb96-33"><a href="figure4.html#cb96-33" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/04.DA_gene.pdf&quot;</span>,DAscore_gene<span class="sc">$</span>p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb96-34"><a href="figure4.html#cb96-34" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/04.DA_gene.png&quot;</span>,DAscore_gene<span class="sc">$</span>p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb96-35"><a href="figure4.html#cb96-35" tabindex="-1"></a><span class="fu">write.table</span>(DAscore_gene<span class="sc">$</span>result,<span class="st">&quot;result/figure4/04.DA_gene.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb96-36"><a href="figure4.html#cb96-36" tabindex="-1"></a></span>
<span id="cb96-37"><a href="figure4.html#cb96-37" tabindex="-1"></a></span>
<span id="cb96-38"><a href="figure4.html#cb96-38" tabindex="-1"></a><span class="do">## metabolite</span></span>
<span id="cb96-39"><a href="figure4.html#cb96-39" tabindex="-1"></a><span class="do">## filter the increase differential genes and metabolites</span></span>
<span id="cb96-40"><a href="figure4.html#cb96-40" tabindex="-1"></a>diff_meta_increase <span class="ot">&lt;-</span> all_meta1 <span class="sc">%&gt;%</span></span>
<span id="cb96-41"><a href="figure4.html#cb96-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-42"><a href="figure4.html#cb96-42" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb96-43"><a href="figure4.html#cb96-43" tabindex="-1"></a></span>
<span id="cb96-44"><a href="figure4.html#cb96-44" tabindex="-1"></a>diff_meta_decrease <span class="ot">&lt;-</span> all_meta1 <span class="sc">%&gt;%</span></span>
<span id="cb96-45"><a href="figure4.html#cb96-45" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logFC <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-46"><a href="figure4.html#cb96-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb96-47"><a href="figure4.html#cb96-47" tabindex="-1"></a></span>
<span id="cb96-48"><a href="figure4.html#cb96-48" tabindex="-1"></a>DAscore_meta <span class="ot">&lt;-</span> <span class="fu">DAscore</span>(diff_meta_increase<span class="sc">$</span>name,diff_meta_decrease<span class="sc">$</span>name,all_meta1<span class="sc">$</span>name,</span>
<span id="cb96-49"><a href="figure4.html#cb96-49" tabindex="-1"></a>                        <span class="at">min_measured_num =</span> <span class="dv">3</span>,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">sort_plot=</span><span class="st">&quot;category&quot;</span>)</span>
<span id="cb96-50"><a href="figure4.html#cb96-50" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/04.DA_meta.pdf&quot;</span>,DAscore_meta<span class="sc">$</span>p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb96-51"><a href="figure4.html#cb96-51" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/04.DA_meta.png&quot;</span>,DAscore_meta<span class="sc">$</span>p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb96-52"><a href="figure4.html#cb96-52" tabindex="-1"></a><span class="fu">write.table</span>(DAscore_meta<span class="sc">$</span>result,<span class="st">&quot;result/figure4/04.DA_meta.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb96-53"><a href="figure4.html#cb96-53" tabindex="-1"></a></span>
<span id="cb96-54"><a href="figure4.html#cb96-54" tabindex="-1"></a><span class="do">## gene and metabolite</span></span>
<span id="cb96-55"><a href="figure4.html#cb96-55" tabindex="-1"></a>DAscore_all <span class="ot">&lt;-</span> <span class="fu">DAscore</span>(<span class="fu">c</span>(diff_gene_increase<span class="sc">$</span>name,diff_meta_increase<span class="sc">$</span>name),</span>
<span id="cb96-56"><a href="figure4.html#cb96-56" tabindex="-1"></a>                       <span class="fu">c</span>(diff_gene_decrease<span class="sc">$</span>name,diff_meta_decrease<span class="sc">$</span>name),</span>
<span id="cb96-57"><a href="figure4.html#cb96-57" tabindex="-1"></a>                       <span class="fu">c</span>(all_gene<span class="sc">$</span>name,all_meta<span class="sc">$</span>name),<span class="at">min_measured_num =</span> <span class="dv">13</span>,</span>
<span id="cb96-58"><a href="figure4.html#cb96-58" tabindex="-1"></a>                       <span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">sort_plot=</span><span class="st">&quot;category&quot;</span>)</span>
<span id="cb96-59"><a href="figure4.html#cb96-59" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/04.DA_all.pdf&quot;</span>,DAscore_all<span class="sc">$</span>p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">10</span>)</span>
<span id="cb96-60"><a href="figure4.html#cb96-60" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/04.DA_all.png&quot;</span>,DAscore_all<span class="sc">$</span>p,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">10</span>)</span>
<span id="cb96-61"><a href="figure4.html#cb96-61" tabindex="-1"></a><span class="fu">write.table</span>(DAscore_all<span class="sc">$</span>result,<span class="st">&quot;result/figure4/04.DA_all.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>Metabolite、Gene</p>
<p><img src="result/figure4/04.DA_meta.png" width="50%" /><img src="result/figure4/04.DA_gene.png" width="50%" /></p>
<p>Metabolite + Gene</p>
<p><img src="result/figure4/04.DA_all.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="esea-analysis" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> ESEA analysis<a href="figure4.html#esea-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="figure4.html#cb97-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb97-2"><a href="figure4.html#cb97-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb97-3"><a href="figure4.html#cb97-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb97-4"><a href="figure4.html#cb97-4" tabindex="-1"></a></span>
<span id="cb97-5"><a href="figure4.html#cb97-5" tabindex="-1"></a>all_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/diff_gene.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-6"><a href="figure4.html#cb97-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb97-7"><a href="figure4.html#cb97-7" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/diff_met.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-8"><a href="figure4.html#cb97-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb97-9"><a href="figure4.html#cb97-9" tabindex="-1"></a></span>
<span id="cb97-10"><a href="figure4.html#cb97-10" tabindex="-1"></a>kid <span class="ot">&lt;-</span> <span class="fu">name2keggid</span>(all_meta<span class="sc">$</span>name)</span>
<span id="cb97-11"><a href="figure4.html#cb97-11" tabindex="-1"></a>kid1 <span class="ot">&lt;-</span> kid <span class="sc">%&gt;%</span></span>
<span id="cb97-12"><a href="figure4.html#cb97-12" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_rows</span>(KEGG_id,<span class="at">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb97-13"><a href="figure4.html#cb97-13" tabindex="-1"></a></span>
<span id="cb97-14"><a href="figure4.html#cb97-14" tabindex="-1"></a>all_meta1 <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span></span>
<span id="cb97-15"><a href="figure4.html#cb97-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kid1,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;Name&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb97-16"><a href="figure4.html#cb97-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(KEGG_id)) <span class="sc">%&gt;%</span></span>
<span id="cb97-17"><a href="figure4.html#cb97-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(P.Value) <span class="sc">%&gt;%</span></span>
<span id="cb97-18"><a href="figure4.html#cb97-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(KEGG_id,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb97-19"><a href="figure4.html#cb97-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb97-20"><a href="figure4.html#cb97-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;KEGG_id&quot;</span>)</span>
<span id="cb97-21"><a href="figure4.html#cb97-21" tabindex="-1"></a></span>
<span id="cb97-22"><a href="figure4.html#cb97-22" tabindex="-1"></a></span>
<span id="cb97-23"><a href="figure4.html#cb97-23" tabindex="-1"></a>all_result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_meta1,all_gene)</span>
<span id="cb97-24"><a href="figure4.html#cb97-24" tabindex="-1"></a></span>
<span id="cb97-25"><a href="figure4.html#cb97-25" tabindex="-1"></a>all <span class="ot">&lt;-</span> all_result<span class="sc">$</span>logFC</span>
<span id="cb97-26"><a href="figure4.html#cb97-26" tabindex="-1"></a><span class="fu">names</span>(all) <span class="ot">&lt;-</span> all_result<span class="sc">$</span>name</span>
<span id="cb97-27"><a href="figure4.html#cb97-27" tabindex="-1"></a></span>
<span id="cb97-28"><a href="figure4.html#cb97-28" tabindex="-1"></a>gene <span class="ot">&lt;-</span> all_gene<span class="sc">$</span>logFC</span>
<span id="cb97-29"><a href="figure4.html#cb97-29" tabindex="-1"></a><span class="fu">names</span>(gene) <span class="ot">&lt;-</span> all_gene<span class="sc">$</span>name</span>
<span id="cb97-30"><a href="figure4.html#cb97-30" tabindex="-1"></a></span>
<span id="cb97-31"><a href="figure4.html#cb97-31" tabindex="-1"></a>meta <span class="ot">&lt;-</span> all_meta1<span class="sc">$</span>logFC</span>
<span id="cb97-32"><a href="figure4.html#cb97-32" tabindex="-1"></a><span class="fu">names</span>(meta) <span class="ot">&lt;-</span> all_meta1<span class="sc">$</span>name</span>
<span id="cb97-33"><a href="figure4.html#cb97-33" tabindex="-1"></a></span>
<span id="cb97-34"><a href="figure4.html#cb97-34" tabindex="-1"></a>result_meta <span class="ot">&lt;-</span> <span class="fu">ESEA</span>(meta,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,<span class="at">minSize =</span> <span class="dv">3</span>)</span>
<span id="cb97-35"><a href="figure4.html#cb97-35" tabindex="-1"></a>result_gene <span class="ot">&lt;-</span> <span class="fu">ESEA</span>(gene,<span class="at">out =</span> <span class="st">&quot;gene&quot;</span>,<span class="at">minSize =</span> <span class="dv">10</span>)</span>
<span id="cb97-36"><a href="figure4.html#cb97-36" tabindex="-1"></a>result_all <span class="ot">&lt;-</span> <span class="fu">ESEA</span>(all,<span class="at">out=</span><span class="st">&quot;Extended&quot;</span>,<span class="at">minSize =</span> <span class="dv">13</span>)</span>
<span id="cb97-37"><a href="figure4.html#cb97-37" tabindex="-1"></a></span>
<span id="cb97-38"><a href="figure4.html#cb97-38" tabindex="-1"></a><span class="fu">write.table</span>(result_gene <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">leadingEdge=</span><span class="fu">as.character</span>(leadingEdge)),<span class="st">&quot;result/figure4/05.gene_gsea.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb97-39"><a href="figure4.html#cb97-39" tabindex="-1"></a><span class="fu">write.table</span>(result_meta <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">leadingEdge=</span><span class="fu">as.character</span>(leadingEdge)),<span class="st">&quot;result/figure4/05.meta_gsea.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb97-40"><a href="figure4.html#cb97-40" tabindex="-1"></a><span class="fu">write.table</span>(result_all <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">leadingEdge=</span><span class="fu">as.character</span>(leadingEdge)),<span class="st">&quot;result/figure4/05.all_gsea.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb97-41"><a href="figure4.html#cb97-41" tabindex="-1"></a></span>
<span id="cb97-42"><a href="figure4.html#cb97-42" tabindex="-1"></a></span>
<span id="cb97-43"><a href="figure4.html#cb97-43" tabindex="-1"></a>kegg_pathway_uniq <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb97-44"><a href="figure4.html#cb97-44" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(kegg_pathwayname,kegg_category) <span class="sc">%&gt;%</span></span>
<span id="cb97-45"><a href="figure4.html#cb97-45" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;PATHWAY&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_pathwayname&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-46"><a href="figure4.html#cb97-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pathway_type&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_category&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-47"><a href="figure4.html#cb97-47" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb97-48"><a href="figure4.html#cb97-48" tabindex="-1"></a></span>
<span id="cb97-49"><a href="figure4.html#cb97-49" tabindex="-1"></a>result_meta_filter <span class="ot">&lt;-</span> result_meta <span class="sc">%&gt;%</span></span>
<span id="cb97-50"><a href="figure4.html#cb97-50" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-51"><a href="figure4.html#cb97-51" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="fu">ifelse</span>(NES<span class="sc">&gt;</span><span class="dv">0</span>,<span class="st">&quot;meta_AML&quot;</span>,<span class="st">&quot;meta_ALL&quot;</span>))</span>
<span id="cb97-52"><a href="figure4.html#cb97-52" tabindex="-1"></a></span>
<span id="cb97-53"><a href="figure4.html#cb97-53" tabindex="-1"></a>result_gene_filter <span class="ot">&lt;-</span> result_gene <span class="sc">%&gt;%</span></span>
<span id="cb97-54"><a href="figure4.html#cb97-54" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-55"><a href="figure4.html#cb97-55" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="fu">ifelse</span>(NES<span class="sc">&gt;</span><span class="dv">0</span>,<span class="st">&quot;gene_AML&quot;</span>,<span class="st">&quot;gene_ALL&quot;</span>))</span>
<span id="cb97-56"><a href="figure4.html#cb97-56" tabindex="-1"></a></span>
<span id="cb97-57"><a href="figure4.html#cb97-57" tabindex="-1"></a>result_all_filter <span class="ot">&lt;-</span> result_all <span class="sc">%&gt;%</span></span>
<span id="cb97-58"><a href="figure4.html#cb97-58" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pval <span class="sc">&lt;</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-59"><a href="figure4.html#cb97-59" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Type=</span><span class="fu">ifelse</span>(NES<span class="sc">&gt;</span><span class="dv">0</span>,<span class="st">&quot;all_AML&quot;</span>,<span class="st">&quot;all_ALL&quot;</span>))</span>
<span id="cb97-60"><a href="figure4.html#cb97-60" tabindex="-1"></a></span>
<span id="cb97-61"><a href="figure4.html#cb97-61" tabindex="-1"></a></span>
<span id="cb97-62"><a href="figure4.html#cb97-62" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_meta_filter,result_gene_filter,result_all_filter)</span>
<span id="cb97-63"><a href="figure4.html#cb97-63" tabindex="-1"></a></span>
<span id="cb97-64"><a href="figure4.html#cb97-64" tabindex="-1"></a>result_filter <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span></span>
<span id="cb97-65"><a href="figure4.html#cb97-65" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kegg_pathway_uniq,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;pathway&quot;</span><span class="ot">=</span><span class="st">&quot;PATHWAY&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb97-66"><a href="figure4.html#cb97-66" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(pval)</span>
<span id="cb97-67"><a href="figure4.html#cb97-67" tabindex="-1"></a></span>
<span id="cb97-68"><a href="figure4.html#cb97-68" tabindex="-1"></a>pathway_hh <span class="ot">&lt;-</span> <span class="fu">unique</span>(result_filter<span class="sc">$</span>pathway_type)</span>
<span id="cb97-69"><a href="figure4.html#cb97-69" tabindex="-1"></a></span>
<span id="cb97-70"><a href="figure4.html#cb97-70" tabindex="-1"></a>result_filter <span class="ot">&lt;-</span> result_filter <span class="sc">%&gt;%</span></span>
<span id="cb97-71"><a href="figure4.html#cb97-71" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(pathway_type,pathway_hh))</span>
<span id="cb97-72"><a href="figure4.html#cb97-72" tabindex="-1"></a></span>
<span id="cb97-73"><a href="figure4.html#cb97-73" tabindex="-1"></a>result_filter<span class="sc">$</span>pathway <span class="ot">&lt;-</span> <span class="fu">factor</span>(result_filter<span class="sc">$</span>pathway,<span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">unique</span>(result_filter<span class="sc">$</span>pathway)))</span>
<span id="cb97-74"><a href="figure4.html#cb97-74" tabindex="-1"></a>result_filter<span class="sc">$</span>pathway_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result_filter<span class="sc">$</span>pathway_type,<span class="at">levels=</span><span class="fu">unique</span>(kegg_pathway_uniq<span class="sc">$</span>pathway_type))</span>
<span id="cb97-75"><a href="figure4.html#cb97-75" tabindex="-1"></a>result_filter<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="fu">factor</span>(result_filter<span class="sc">$</span>Type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;meta_AML&quot;</span>,<span class="st">&quot;meta_ALL&quot;</span>,</span>
<span id="cb97-76"><a href="figure4.html#cb97-76" tabindex="-1"></a>                                                         <span class="st">&quot;gene_AML&quot;</span>,<span class="st">&quot;gene_ALL&quot;</span>,<span class="st">&quot;all_AML&quot;</span>,<span class="st">&quot;all_ALL&quot;</span>))</span>
<span id="cb97-77"><a href="figure4.html#cb97-77" tabindex="-1"></a></span>
<span id="cb97-78"><a href="figure4.html#cb97-78" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result_filter,<span class="fu">aes</span>(pathway,<span class="sc">-</span><span class="fu">log10</span>(pval))) <span class="sc">+</span></span>
<span id="cb97-79"><a href="figure4.html#cb97-79" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>pathway_type))<span class="sc">+</span></span>
<span id="cb97-80"><a href="figure4.html#cb97-80" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">11</span>, <span class="st">&quot;Set3&quot;</span>),<span class="at">name=</span><span class="st">&quot;Pathway Category&quot;</span>,</span>
<span id="cb97-81"><a href="figure4.html#cb97-81" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">unique</span>(kegg_pathway_uniq<span class="sc">$</span>pathway_type))<span class="sc">+</span></span>
<span id="cb97-82"><a href="figure4.html#cb97-82" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb97-83"><a href="figure4.html#cb97-83" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Type,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)<span class="sc">+</span></span>
<span id="cb97-84"><a href="figure4.html#cb97-84" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb97-85"><a href="figure4.html#cb97-85" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb97-86"><a href="figure4.html#cb97-86" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb97-87"><a href="figure4.html#cb97-87" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/05.ESEA_facet.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">15</span>,<span class="at">height =</span> <span class="dv">7</span>)</span>
<span id="cb97-88"><a href="figure4.html#cb97-88" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/05.ESEA_facet.png&quot;</span>,p,<span class="at">width=</span><span class="dv">15</span>,<span class="at">height =</span> <span class="dv">7</span>)</span></code></pre></div>
<p><img src="result/figure4/05.ESEA_facet.png" width="2250" style="display: block; margin: auto;" /></p>
</div>
<div id="aml-epe-analysis" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> AML EPE analysis<a href="figure4.html#aml-epe-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="figure4.html#cb98-1" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb98-2"><a href="figure4.html#cb98-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb98-3"><a href="figure4.html#cb98-3" tabindex="-1"></a></span>
<span id="cb98-4"><a href="figure4.html#cb98-4" tabindex="-1"></a>AML_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/01.gene_increase.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb98-5"><a href="figure4.html#cb98-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb98-6"><a href="figure4.html#cb98-6" tabindex="-1"></a>AML_meta <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/02.meta_increase.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb98-7"><a href="figure4.html#cb98-7" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb98-8"><a href="figure4.html#cb98-8" tabindex="-1"></a>AML_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/03.all_increase.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb98-9"><a href="figure4.html#cb98-9" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb98-10"><a href="figure4.html#cb98-10" tabindex="-1"></a></span>
<span id="cb98-11"><a href="figure4.html#cb98-11" tabindex="-1"></a>pathway_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(AML_gene,AML_meta,AML_all) <span class="sc">%&gt;%</span></span>
<span id="cb98-12"><a href="figure4.html#cb98-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>) <span class="sc">%&gt;%</span></span>
<span id="cb98-13"><a href="figure4.html#cb98-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb98-14"><a href="figure4.html#cb98-14" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb98-15"><a href="figure4.html#cb98-15" tabindex="-1"></a><span class="fu">write.table</span>(pathway_all,<span class="st">&quot;result/figure4/06.AML_pathway.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="at">col.names =</span> F)</span>
<span id="cb98-16"><a href="figure4.html#cb98-16" tabindex="-1"></a></span>
<span id="cb98-17"><a href="figure4.html#cb98-17" tabindex="-1"></a>result_gene_filter <span class="ot">&lt;-</span> AML_gene <span class="sc">%&gt;%</span></span>
<span id="cb98-18"><a href="figure4.html#cb98-18" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb98-19"><a href="figure4.html#cb98-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb98-20"><a href="figure4.html#cb98-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb98-21"><a href="figure4.html#cb98-21" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb98-22"><a href="figure4.html#cb98-22" tabindex="-1"></a></span>
<span id="cb98-23"><a href="figure4.html#cb98-23" tabindex="-1"></a>result_meta_filter <span class="ot">&lt;-</span> AML_meta <span class="sc">%&gt;%</span></span>
<span id="cb98-24"><a href="figure4.html#cb98-24" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb98-25"><a href="figure4.html#cb98-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb98-26"><a href="figure4.html#cb98-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb98-27"><a href="figure4.html#cb98-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb98-28"><a href="figure4.html#cb98-28" tabindex="-1"></a></span>
<span id="cb98-29"><a href="figure4.html#cb98-29" tabindex="-1"></a>result_all_filter <span class="ot">&lt;-</span> AML_all <span class="sc">%&gt;%</span></span>
<span id="cb98-30"><a href="figure4.html#cb98-30" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb98-31"><a href="figure4.html#cb98-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb98-32"><a href="figure4.html#cb98-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb98-33"><a href="figure4.html#cb98-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb98-34"><a href="figure4.html#cb98-34" tabindex="-1"></a></span>
<span id="cb98-35"><a href="figure4.html#cb98-35" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_gene_filter,result_meta_filter,result_all_filter) <span class="sc">%&gt;%</span></span>
<span id="cb98-36"><a href="figure4.html#cb98-36" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">adjp=</span><span class="fu">ifelse</span>(pvalue <span class="sc">&lt;</span> <span class="fl">3.8e-04</span> ,<span class="fl">3.8e-04</span>,pvalue)) <span class="sc">%&gt;%</span></span>
<span id="cb98-37"><a href="figure4.html#cb98-37" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">factor</span>(type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>)))</span>
<span id="cb98-38"><a href="figure4.html#cb98-38" tabindex="-1"></a></span>
<span id="cb98-39"><a href="figure4.html#cb98-39" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all,<span class="fu">aes</span>(type,name))<span class="sc">+</span></span>
<span id="cb98-40"><a href="figure4.html#cb98-40" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>nOverlap,<span class="at">color=</span><span class="sc">-</span><span class="fu">log10</span>(pvalue)))<span class="sc">+</span></span>
<span id="cb98-41"><a href="figure4.html#cb98-41" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb98-42"><a href="figure4.html#cb98-42" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb98-43"><a href="figure4.html#cb98-43" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb98-44"><a href="figure4.html#cb98-44" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low=</span><span class="st">&quot;white&quot;</span>,<span class="at">high=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb98-45"><a href="figure4.html#cb98-45" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>,<span class="at">y=</span><span class="st">&quot;Pathway name&quot;</span>)</span>
<span id="cb98-46"><a href="figure4.html#cb98-46" tabindex="-1"></a></span>
<span id="cb98-47"><a href="figure4.html#cb98-47" tabindex="-1"></a></span>
<span id="cb98-48"><a href="figure4.html#cb98-48" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/06.AML.EPEA.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb98-49"><a href="figure4.html#cb98-49" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/06.AML.EPEA.png&quot;</span>,p,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="result/figure4/06.AML.EPEA.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="volcano-plot-1" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Volcano plot<a href="figure4.html#volcano-plot-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="differential-metabolites-and-genes" class="section level3 hasAnchor" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> Differential metabolites and genes<a href="figure4.html#differential-metabolites-and-genes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="figure4.html#cb99-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb99-2"><a href="figure4.html#cb99-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb99-3"><a href="figure4.html#cb99-3" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb99-4"><a href="figure4.html#cb99-4" tabindex="-1"></a></span>
<span id="cb99-5"><a href="figure4.html#cb99-5" tabindex="-1"></a>dat_met <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/diff_met.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-6"><a href="figure4.html#cb99-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb99-7"><a href="figure4.html#cb99-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Condition=</span><span class="fu">ifelse</span>(logFC <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> P.Value <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">&quot;Up&quot;</span>,</span>
<span id="cb99-8"><a href="figure4.html#cb99-8" tabindex="-1"></a>                                 <span class="fu">ifelse</span>(logFC <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> P.Value <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">&quot;Down&quot;</span>,<span class="st">&quot;Not Sig&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb99-9"><a href="figure4.html#cb99-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">label=</span><span class="fu">ifelse</span>(Condition<span class="sc">==</span><span class="st">&quot;Not Sig&quot;</span>,<span class="st">&quot;&quot;</span>,name))</span>
<span id="cb99-10"><a href="figure4.html#cb99-10" tabindex="-1"></a></span>
<span id="cb99-11"><a href="figure4.html#cb99-11" tabindex="-1"></a></span>
<span id="cb99-12"><a href="figure4.html#cb99-12" tabindex="-1"></a>p <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(dat_met,ggplot2<span class="sc">::</span><span class="fu">aes</span>(logFC,<span class="sc">-</span><span class="fu">log2</span>(P.Value)))<span class="sc">+</span></span>
<span id="cb99-13"><a href="figure4.html#cb99-13" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">color=</span>Condition),<span class="at">size=</span><span class="dv">2</span>,<span class="at">alpha=</span><span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb99-14"><a href="figure4.html#cb99-14" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(<span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>,<span class="at">color=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span></span>
<span id="cb99-15"><a href="figure4.html#cb99-15" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fu">log2</span>(<span class="fl">0.05</span>),<span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>,<span class="at">color=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span></span>
<span id="cb99-16"><a href="figure4.html#cb99-16" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">label=</span>label),<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb99-17"><a href="figure4.html#cb99-17" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Up&quot;</span><span class="ot">=</span><span class="st">&quot;red&quot;</span>,<span class="st">&quot;Not Sig&quot;</span><span class="ot">=</span><span class="st">&quot;gray&quot;</span>,<span class="st">&quot;Down&quot;</span><span class="ot">=</span><span class="st">&quot;blue&quot;</span>))<span class="sc">+</span></span>
<span id="cb99-18"><a href="figure4.html#cb99-18" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb99-19"><a href="figure4.html#cb99-19" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid.major =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),<span class="at">panel.grid.minor =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb99-20"><a href="figure4.html#cb99-20" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;log2(Fold Change)&quot;</span>,<span class="at">y=</span><span class="st">&quot;-log2(P Value)&quot;</span>)</span>
<span id="cb99-21"><a href="figure4.html#cb99-21" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/07.volcano_met.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span><span class="dv">5</span>)</span>
<span id="cb99-22"><a href="figure4.html#cb99-22" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/07.volcano_met.png&quot;</span>,p,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span><span class="dv">5</span>)</span>
<span id="cb99-23"><a href="figure4.html#cb99-23" tabindex="-1"></a></span>
<span id="cb99-24"><a href="figure4.html#cb99-24" tabindex="-1"></a>dat_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/diff_gene.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-25"><a href="figure4.html#cb99-25" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb99-26"><a href="figure4.html#cb99-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Condition=</span><span class="fu">ifelse</span>(logFC <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> P.Value <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">&quot;Up&quot;</span>,</span>
<span id="cb99-27"><a href="figure4.html#cb99-27" tabindex="-1"></a>                                 <span class="fu">ifelse</span>(logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> P.Value <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">&quot;Down&quot;</span>,<span class="st">&quot;Not Sig&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb99-28"><a href="figure4.html#cb99-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">label=</span><span class="fu">ifelse</span>(Condition<span class="sc">==</span><span class="st">&quot;Not Sig&quot;</span>,<span class="st">&quot;&quot;</span>,name))</span>
<span id="cb99-29"><a href="figure4.html#cb99-29" tabindex="-1"></a></span>
<span id="cb99-30"><a href="figure4.html#cb99-30" tabindex="-1"></a></span>
<span id="cb99-31"><a href="figure4.html#cb99-31" tabindex="-1"></a>p <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(dat_gene,ggplot2<span class="sc">::</span><span class="fu">aes</span>(logFC,<span class="sc">-</span><span class="fu">log2</span>(P.Value)))<span class="sc">+</span></span>
<span id="cb99-32"><a href="figure4.html#cb99-32" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">color=</span>Condition),<span class="at">size=</span><span class="dv">2</span>,<span class="at">alpha=</span><span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb99-33"><a href="figure4.html#cb99-33" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>,<span class="at">color=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span></span>
<span id="cb99-34"><a href="figure4.html#cb99-34" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fu">log2</span>(<span class="fl">0.05</span>),<span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>,<span class="at">color=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span></span>
<span id="cb99-35"><a href="figure4.html#cb99-35" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">label=</span>label),<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb99-36"><a href="figure4.html#cb99-36" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Up&quot;</span><span class="ot">=</span><span class="st">&quot;red&quot;</span>,<span class="st">&quot;Not Sig&quot;</span><span class="ot">=</span><span class="st">&quot;gray&quot;</span>,<span class="st">&quot;Down&quot;</span><span class="ot">=</span><span class="st">&quot;blue&quot;</span>))<span class="sc">+</span></span>
<span id="cb99-37"><a href="figure4.html#cb99-37" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb99-38"><a href="figure4.html#cb99-38" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid.major =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),<span class="at">panel.grid.minor =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb99-39"><a href="figure4.html#cb99-39" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;log2(Fold Change)&quot;</span>,<span class="at">y=</span><span class="st">&quot;-log2(P Value)&quot;</span>)</span>
<span id="cb99-40"><a href="figure4.html#cb99-40" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/07.volcano_gene.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span><span class="dv">5</span>)</span>
<span id="cb99-41"><a href="figure4.html#cb99-41" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/07.volcano_gene.png&quot;</span>,p,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span><span class="dv">5</span>)</span></code></pre></div>
<p>Metabolite、Gene</p>
<p><img src="result/figure4/07.volcano_met.png" width="50%" /><img src="result/figure4/07.volcano_gene.png" width="50%" /></p>
</div>
<div id="all" class="section level3 hasAnchor" number="7.7.2">
<h3><span class="header-section-number">7.7.2</span> ALL<a href="figure4.html#all" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="figure4.html#cb100-1" tabindex="-1"></a>kegg_pathway_uniq <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb100-2"><a href="figure4.html#cb100-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(kegg_pathwayname,kegg_category) <span class="sc">%&gt;%</span></span>
<span id="cb100-3"><a href="figure4.html#cb100-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;PATHWAY&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_pathwayname&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-4"><a href="figure4.html#cb100-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pathway_type&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_category&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-5"><a href="figure4.html#cb100-5" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb100-6"><a href="figure4.html#cb100-6" tabindex="-1"></a></span>
<span id="cb100-7"><a href="figure4.html#cb100-7" tabindex="-1"></a>ALL_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/01.gene_decrease.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-8"><a href="figure4.html#cb100-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb100-9"><a href="figure4.html#cb100-9" tabindex="-1"></a>ALL_meta <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/02.meta_decrease.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-10"><a href="figure4.html#cb100-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb100-11"><a href="figure4.html#cb100-11" tabindex="-1"></a>ALL_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/03.all_decrease.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-12"><a href="figure4.html#cb100-12" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb100-13"><a href="figure4.html#cb100-13" tabindex="-1"></a></span>
<span id="cb100-14"><a href="figure4.html#cb100-14" tabindex="-1"></a>pathway_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ALL_gene,ALL_meta,ALL_all) <span class="sc">%&gt;%</span></span>
<span id="cb100-15"><a href="figure4.html#cb100-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-16"><a href="figure4.html#cb100-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Lysine degradation&quot;</span>,<span class="st">&quot;Glutathione metabolism&quot;</span>,</span>
<span id="cb100-17"><a href="figure4.html#cb100-17" tabindex="-1"></a>                             <span class="st">&quot;Butanoate metabolism&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb100-18"><a href="figure4.html#cb100-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb100-19"><a href="figure4.html#cb100-19" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb100-20"><a href="figure4.html#cb100-20" tabindex="-1"></a>pathway_all <span class="ot">&lt;-</span> <span class="fu">c</span>(pathway_all,<span class="st">&quot;Alanine, aspartate and glutamate metabolism&quot;</span>,</span>
<span id="cb100-21"><a href="figure4.html#cb100-21" tabindex="-1"></a>                 <span class="st">&quot;Biosynthesis of unsaturated fatty acids&quot;</span>)</span>
<span id="cb100-22"><a href="figure4.html#cb100-22" tabindex="-1"></a><span class="fu">write.table</span>(pathway_all,<span class="st">&quot;result/figure4/08.ALL_pathway.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="at">col.names =</span> F)</span>
<span id="cb100-23"><a href="figure4.html#cb100-23" tabindex="-1"></a></span>
<span id="cb100-24"><a href="figure4.html#cb100-24" tabindex="-1"></a>result_gene_filter <span class="ot">&lt;-</span> ALL_gene <span class="sc">%&gt;%</span></span>
<span id="cb100-25"><a href="figure4.html#cb100-25" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb100-26"><a href="figure4.html#cb100-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb100-27"><a href="figure4.html#cb100-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb100-28"><a href="figure4.html#cb100-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb100-29"><a href="figure4.html#cb100-29" tabindex="-1"></a></span>
<span id="cb100-30"><a href="figure4.html#cb100-30" tabindex="-1"></a>result_meta_filter <span class="ot">&lt;-</span> ALL_meta <span class="sc">%&gt;%</span></span>
<span id="cb100-31"><a href="figure4.html#cb100-31" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb100-32"><a href="figure4.html#cb100-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb100-33"><a href="figure4.html#cb100-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb100-34"><a href="figure4.html#cb100-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb100-35"><a href="figure4.html#cb100-35" tabindex="-1"></a></span>
<span id="cb100-36"><a href="figure4.html#cb100-36" tabindex="-1"></a>result_all_filter <span class="ot">&lt;-</span> ALL_all <span class="sc">%&gt;%</span></span>
<span id="cb100-37"><a href="figure4.html#cb100-37" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb100-38"><a href="figure4.html#cb100-38" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb100-39"><a href="figure4.html#cb100-39" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb100-40"><a href="figure4.html#cb100-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb100-41"><a href="figure4.html#cb100-41" tabindex="-1"></a></span>
<span id="cb100-42"><a href="figure4.html#cb100-42" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_gene_filter,result_meta_filter,result_all_filter) <span class="sc">%&gt;%</span></span>
<span id="cb100-43"><a href="figure4.html#cb100-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">adjp=</span><span class="fu">ifelse</span>(pvalue <span class="sc">&lt;</span> <span class="fl">3.8e-04</span> ,<span class="fl">3.8e-04</span>,pvalue)) <span class="sc">%&gt;%</span></span>
<span id="cb100-44"><a href="figure4.html#cb100-44" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">factor</span>(type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>)))</span>
<span id="cb100-45"><a href="figure4.html#cb100-45" tabindex="-1"></a></span>
<span id="cb100-46"><a href="figure4.html#cb100-46" tabindex="-1"></a>p_epea <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all,<span class="fu">aes</span>(type,name))<span class="sc">+</span></span>
<span id="cb100-47"><a href="figure4.html#cb100-47" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="fu">log2</span>(nOverlap),<span class="at">color=</span><span class="sc">-</span><span class="fu">log10</span>(pvalue)))<span class="sc">+</span></span>
<span id="cb100-48"><a href="figure4.html#cb100-48" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb100-49"><a href="figure4.html#cb100-49" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb100-50"><a href="figure4.html#cb100-50" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb100-51"><a href="figure4.html#cb100-51" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low=</span><span class="st">&quot;white&quot;</span>,<span class="at">high=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb100-52"><a href="figure4.html#cb100-52" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>,<span class="at">y=</span><span class="st">&quot;Pathway name&quot;</span>)</span>
<span id="cb100-53"><a href="figure4.html#cb100-53" tabindex="-1"></a></span>
<span id="cb100-54"><a href="figure4.html#cb100-54" tabindex="-1"></a>DA_met <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/04.DA_meta.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-55"><a href="figure4.html#cb100-55" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb100-56"><a href="figure4.html#cb100-56" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Pathway <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb100-57"><a href="figure4.html#cb100-57" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb100-58"><a href="figure4.html#cb100-58" tabindex="-1"></a>DA_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/04.DA_gene.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-59"><a href="figure4.html#cb100-59" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb100-60"><a href="figure4.html#cb100-60" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Pathway <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb100-61"><a href="figure4.html#cb100-61" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb100-62"><a href="figure4.html#cb100-62" tabindex="-1"></a>DA_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/04.DA_all.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-63"><a href="figure4.html#cb100-63" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb100-64"><a href="figure4.html#cb100-64" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Pathway <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb100-65"><a href="figure4.html#cb100-65" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb100-66"><a href="figure4.html#cb100-66" tabindex="-1"></a>DA_result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DA_met,DA_gene,DA_all)</span>
<span id="cb100-67"><a href="figure4.html#cb100-67" tabindex="-1"></a></span>
<span id="cb100-68"><a href="figure4.html#cb100-68" tabindex="-1"></a>p_da <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(DA_result)<span class="sc">+</span></span>
<span id="cb100-69"><a href="figure4.html#cb100-69" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x=</span>Pathway,<span class="at">y=</span>DA_score,<span class="at">size=</span><span class="fu">log2</span>(Measured_members_num),<span class="at">color=</span><span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb100-70"><a href="figure4.html#cb100-70" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_pointrange</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x=</span>Pathway,<span class="at">y=</span>DA_score,<span class="at">ymin=</span><span class="dv">0</span>,<span class="at">ymax=</span>DA_score,<span class="at">color=</span><span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb100-71"><a href="figure4.html#cb100-71" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">11</span>, <span class="st">&quot;Set3&quot;</span>),<span class="at">name=</span><span class="st">&quot;Pathway Category&quot;</span>,</span>
<span id="cb100-72"><a href="figure4.html#cb100-72" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">unique</span>(kegg_pathway_uniq<span class="sc">$</span>pathway_type))<span class="sc">+</span></span>
<span id="cb100-73"><a href="figure4.html#cb100-73" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb100-74"><a href="figure4.html#cb100-74" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb100-75"><a href="figure4.html#cb100-75" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),<span class="at">axis.text.y=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb100-76"><a href="figure4.html#cb100-76" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb100-77"><a href="figure4.html#cb100-77" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb100-78"><a href="figure4.html#cb100-78" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb100-79"><a href="figure4.html#cb100-79" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)</span>
<span id="cb100-80"><a href="figure4.html#cb100-80" tabindex="-1"></a></span>
<span id="cb100-81"><a href="figure4.html#cb100-81" tabindex="-1"></a>gsea_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/05.gene_gsea.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-82"><a href="figure4.html#cb100-82" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb100-83"><a href="figure4.html#cb100-83" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb100-84"><a href="figure4.html#cb100-84" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb100-85"><a href="figure4.html#cb100-85" tabindex="-1"></a>gsea_meta <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/05.meta_gsea.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-86"><a href="figure4.html#cb100-86" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb100-87"><a href="figure4.html#cb100-87" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb100-88"><a href="figure4.html#cb100-88" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb100-89"><a href="figure4.html#cb100-89" tabindex="-1"></a>gsea_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/05.all_gsea.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-90"><a href="figure4.html#cb100-90" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb100-91"><a href="figure4.html#cb100-91" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb100-92"><a href="figure4.html#cb100-92" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb100-93"><a href="figure4.html#cb100-93" tabindex="-1"></a>gsea_result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(gsea_gene,gsea_meta,gsea_all)</span>
<span id="cb100-94"><a href="figure4.html#cb100-94" tabindex="-1"></a>p_gsea <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gsea_result,<span class="fu">aes</span>(pathway,NES,<span class="at">fill=</span><span class="sc">-</span><span class="fu">log10</span>(pval)))<span class="sc">+</span></span>
<span id="cb100-95"><a href="figure4.html#cb100-95" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb100-96"><a href="figure4.html#cb100-96" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb100-97"><a href="figure4.html#cb100-97" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb100-98"><a href="figure4.html#cb100-98" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb100-99"><a href="figure4.html#cb100-99" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb100-100"><a href="figure4.html#cb100-100" tabindex="-1"></a>        <span class="at">axis.text.y=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb100-101"><a href="figure4.html#cb100-101" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;white&quot;</span>,<span class="at">high=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb100-102"><a href="figure4.html#cb100-102" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb100-103"><a href="figure4.html#cb100-103" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)<span class="sc">+</span></span>
<span id="cb100-104"><a href="figure4.html#cb100-104" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Pathway name&quot;</span>)</span>
<span id="cb100-105"><a href="figure4.html#cb100-105" tabindex="-1"></a></span>
<span id="cb100-106"><a href="figure4.html#cb100-106" tabindex="-1"></a>p <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="at">plotlist =</span> <span class="fu">list</span>(p_epea,p_da,p_gsea),<span class="at">nrow=</span><span class="dv">1</span>)</span>
<span id="cb100-107"><a href="figure4.html#cb100-107" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/08.ALL.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">26</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb100-108"><a href="figure4.html#cb100-108" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/08.ALL.png&quot;</span>,p,<span class="at">width=</span><span class="dv">26</span>,<span class="at">height =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="result/figure4/08.ALL.png" width="3900" style="display: block; margin: auto;" /></p>
</div>
<div id="aml" class="section level3 hasAnchor" number="7.7.3">
<h3><span class="header-section-number">7.7.3</span> AML<a href="figure4.html#aml" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="figure4.html#cb101-1" tabindex="-1"></a>kegg_pathway_uniq <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb101-2"><a href="figure4.html#cb101-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(kegg_pathwayname,kegg_category) <span class="sc">%&gt;%</span></span>
<span id="cb101-3"><a href="figure4.html#cb101-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;PATHWAY&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_pathwayname&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-4"><a href="figure4.html#cb101-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;pathway_type&quot;</span><span class="ot">=</span><span class="st">&quot;kegg_category&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-5"><a href="figure4.html#cb101-5" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb101-6"><a href="figure4.html#cb101-6" tabindex="-1"></a></span>
<span id="cb101-7"><a href="figure4.html#cb101-7" tabindex="-1"></a>AML_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/01.gene_increase.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-8"><a href="figure4.html#cb101-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb101-9"><a href="figure4.html#cb101-9" tabindex="-1"></a>AML_meta <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/02.meta_increase.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-10"><a href="figure4.html#cb101-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb101-11"><a href="figure4.html#cb101-11" tabindex="-1"></a>AML_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/03.all_increase.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-12"><a href="figure4.html#cb101-12" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb101-13"><a href="figure4.html#cb101-13" tabindex="-1"></a></span>
<span id="cb101-14"><a href="figure4.html#cb101-14" tabindex="-1"></a>pathway_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(AML_gene,AML_meta,AML_all) <span class="sc">%&gt;%</span></span>
<span id="cb101-15"><a href="figure4.html#cb101-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-16"><a href="figure4.html#cb101-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb101-17"><a href="figure4.html#cb101-17" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb101-18"><a href="figure4.html#cb101-18" tabindex="-1"></a><span class="fu">write.table</span>(pathway_all,<span class="st">&quot;result/figure4/09.AML_pathway.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="at">col.names =</span> F)</span>
<span id="cb101-19"><a href="figure4.html#cb101-19" tabindex="-1"></a></span>
<span id="cb101-20"><a href="figure4.html#cb101-20" tabindex="-1"></a>result_gene_filter <span class="ot">&lt;-</span> AML_gene <span class="sc">%&gt;%</span></span>
<span id="cb101-21"><a href="figure4.html#cb101-21" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-22"><a href="figure4.html#cb101-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb101-23"><a href="figure4.html#cb101-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb101-24"><a href="figure4.html#cb101-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb101-25"><a href="figure4.html#cb101-25" tabindex="-1"></a></span>
<span id="cb101-26"><a href="figure4.html#cb101-26" tabindex="-1"></a>result_meta_filter <span class="ot">&lt;-</span> AML_meta <span class="sc">%&gt;%</span></span>
<span id="cb101-27"><a href="figure4.html#cb101-27" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-28"><a href="figure4.html#cb101-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb101-29"><a href="figure4.html#cb101-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb101-30"><a href="figure4.html#cb101-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb101-31"><a href="figure4.html#cb101-31" tabindex="-1"></a></span>
<span id="cb101-32"><a href="figure4.html#cb101-32" tabindex="-1"></a>result_all_filter <span class="ot">&lt;-</span> AML_all <span class="sc">%&gt;%</span></span>
<span id="cb101-33"><a href="figure4.html#cb101-33" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-34"><a href="figure4.html#cb101-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,nOverlap,pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb101-35"><a href="figure4.html#cb101-35" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb101-36"><a href="figure4.html#cb101-36" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb101-37"><a href="figure4.html#cb101-37" tabindex="-1"></a></span>
<span id="cb101-38"><a href="figure4.html#cb101-38" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_gene_filter,result_meta_filter,result_all_filter) <span class="sc">%&gt;%</span></span>
<span id="cb101-39"><a href="figure4.html#cb101-39" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">adjp=</span><span class="fu">ifelse</span>(pvalue <span class="sc">&lt;</span> <span class="fl">3.8e-04</span> ,<span class="fl">3.8e-04</span>,pvalue)) <span class="sc">%&gt;%</span></span>
<span id="cb101-40"><a href="figure4.html#cb101-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">factor</span>(type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;metabolite&quot;</span>,<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;all&quot;</span>)))</span>
<span id="cb101-41"><a href="figure4.html#cb101-41" tabindex="-1"></a></span>
<span id="cb101-42"><a href="figure4.html#cb101-42" tabindex="-1"></a>p_epea <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all,<span class="fu">aes</span>(type,name))<span class="sc">+</span></span>
<span id="cb101-43"><a href="figure4.html#cb101-43" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="fu">log2</span>(nOverlap),<span class="at">color=</span><span class="sc">-</span><span class="fu">log10</span>(pvalue)))<span class="sc">+</span></span>
<span id="cb101-44"><a href="figure4.html#cb101-44" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb101-45"><a href="figure4.html#cb101-45" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb101-46"><a href="figure4.html#cb101-46" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb101-47"><a href="figure4.html#cb101-47" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low=</span><span class="st">&quot;white&quot;</span>,<span class="at">high=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb101-48"><a href="figure4.html#cb101-48" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>,<span class="at">y=</span><span class="st">&quot;Pathway name&quot;</span>)</span>
<span id="cb101-49"><a href="figure4.html#cb101-49" tabindex="-1"></a></span>
<span id="cb101-50"><a href="figure4.html#cb101-50" tabindex="-1"></a>DA_met <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/04.DA_meta.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-51"><a href="figure4.html#cb101-51" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-52"><a href="figure4.html#cb101-52" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Pathway <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb101-53"><a href="figure4.html#cb101-53" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb101-54"><a href="figure4.html#cb101-54" tabindex="-1"></a>DA_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/04.DA_gene.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-55"><a href="figure4.html#cb101-55" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-56"><a href="figure4.html#cb101-56" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Pathway <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb101-57"><a href="figure4.html#cb101-57" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb101-58"><a href="figure4.html#cb101-58" tabindex="-1"></a>DA_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/04.DA_all.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-59"><a href="figure4.html#cb101-59" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-60"><a href="figure4.html#cb101-60" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Pathway <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb101-61"><a href="figure4.html#cb101-61" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb101-62"><a href="figure4.html#cb101-62" tabindex="-1"></a>DA_result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DA_met,DA_gene,DA_all)</span>
<span id="cb101-63"><a href="figure4.html#cb101-63" tabindex="-1"></a></span>
<span id="cb101-64"><a href="figure4.html#cb101-64" tabindex="-1"></a>p_da <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(DA_result)<span class="sc">+</span></span>
<span id="cb101-65"><a href="figure4.html#cb101-65" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x=</span>Pathway,<span class="at">y=</span>DA_score,<span class="at">size=</span><span class="fu">log2</span>(Measured_members_num),<span class="at">color=</span><span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb101-66"><a href="figure4.html#cb101-66" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_pointrange</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x=</span>Pathway,<span class="at">y=</span>DA_score,<span class="at">ymin=</span><span class="dv">0</span>,<span class="at">ymax=</span>DA_score,<span class="at">color=</span><span class="st">`</span><span class="at">Pathway Category</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb101-67"><a href="figure4.html#cb101-67" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">11</span>, <span class="st">&quot;Set3&quot;</span>),<span class="at">name=</span><span class="st">&quot;Pathway Category&quot;</span>,</span>
<span id="cb101-68"><a href="figure4.html#cb101-68" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">unique</span>(kegg_pathway_uniq<span class="sc">$</span>pathway_type))<span class="sc">+</span></span>
<span id="cb101-69"><a href="figure4.html#cb101-69" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb101-70"><a href="figure4.html#cb101-70" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb101-71"><a href="figure4.html#cb101-71" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),<span class="at">axis.text.y=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb101-72"><a href="figure4.html#cb101-72" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb101-73"><a href="figure4.html#cb101-73" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb101-74"><a href="figure4.html#cb101-74" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb101-75"><a href="figure4.html#cb101-75" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)</span>
<span id="cb101-76"><a href="figure4.html#cb101-76" tabindex="-1"></a></span>
<span id="cb101-77"><a href="figure4.html#cb101-77" tabindex="-1"></a>gsea_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/05.gene_gsea.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-78"><a href="figure4.html#cb101-78" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-79"><a href="figure4.html#cb101-79" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb101-80"><a href="figure4.html#cb101-80" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb101-81"><a href="figure4.html#cb101-81" tabindex="-1"></a>gsea_meta <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/05.meta_gsea.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-82"><a href="figure4.html#cb101-82" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-83"><a href="figure4.html#cb101-83" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb101-84"><a href="figure4.html#cb101-84" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb101-85"><a href="figure4.html#cb101-85" tabindex="-1"></a>gsea_all <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/05.all_gsea.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-86"><a href="figure4.html#cb101-86" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-87"><a href="figure4.html#cb101-87" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(pathway <span class="sc">%in%</span> pathway_all) <span class="sc">%&gt;%</span></span>
<span id="cb101-88"><a href="figure4.html#cb101-88" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb101-89"><a href="figure4.html#cb101-89" tabindex="-1"></a>gsea_result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(gsea_gene,gsea_meta,gsea_all)</span>
<span id="cb101-90"><a href="figure4.html#cb101-90" tabindex="-1"></a>p_gsea <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gsea_result,<span class="fu">aes</span>(pathway,NES,<span class="at">fill=</span><span class="sc">-</span><span class="fu">log10</span>(pval)))<span class="sc">+</span></span>
<span id="cb101-91"><a href="figure4.html#cb101-91" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb101-92"><a href="figure4.html#cb101-92" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb101-93"><a href="figure4.html#cb101-93" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb101-94"><a href="figure4.html#cb101-94" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb101-95"><a href="figure4.html#cb101-95" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb101-96"><a href="figure4.html#cb101-96" tabindex="-1"></a>        <span class="at">axis.text.y=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb101-97"><a href="figure4.html#cb101-97" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;white&quot;</span>,<span class="at">high=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb101-98"><a href="figure4.html#cb101-98" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb101-99"><a href="figure4.html#cb101-99" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)<span class="sc">+</span></span>
<span id="cb101-100"><a href="figure4.html#cb101-100" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Pathway name&quot;</span>)</span>
<span id="cb101-101"><a href="figure4.html#cb101-101" tabindex="-1"></a></span>
<span id="cb101-102"><a href="figure4.html#cb101-102" tabindex="-1"></a>p <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="at">plotlist =</span> <span class="fu">list</span>(p_epea,p_da,p_gsea),<span class="at">nrow=</span><span class="dv">1</span>)</span>
<span id="cb101-103"><a href="figure4.html#cb101-103" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/09.AML.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">26</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb101-104"><a href="figure4.html#cb101-104" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/figure4/09.AML.png&quot;</span>,p,<span class="at">width=</span><span class="dv">26</span>,<span class="at">height =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="result/figure4/09.AML.png" width="120%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="heatmap-1" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> Heatmap<a href="figure4.html#heatmap-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="figure4.html#cb102-1" tabindex="-1"></a><span class="do">## Heatmap_metabolite</span></span>
<span id="cb102-2"><a href="figure4.html#cb102-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb102-3"><a href="figure4.html#cb102-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb102-4"><a href="figure4.html#cb102-4" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb102-5"><a href="figure4.html#cb102-5" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb102-6"><a href="figure4.html#cb102-6" tabindex="-1"></a></span>
<span id="cb102-7"><a href="figure4.html#cb102-7" tabindex="-1"></a>diff_met <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/diff_met.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-8"><a href="figure4.html#cb102-8" tabindex="-1"></a> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb102-9"><a href="figure4.html#cb102-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb102-10"><a href="figure4.html#cb102-10" tabindex="-1"></a></span>
<span id="cb102-11"><a href="figure4.html#cb102-11" tabindex="-1"></a>dat_met <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/0.data_meta.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-12"><a href="figure4.html#cb102-12" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb102-13"><a href="figure4.html#cb102-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(V1 <span class="sc">%in%</span> diff_met<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb102-14"><a href="figure4.html#cb102-14" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;V1&quot;</span>)</span>
<span id="cb102-15"><a href="figure4.html#cb102-15" tabindex="-1"></a>sample <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/0.sample.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-16"><a href="figure4.html#cb102-16" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb102-17"><a href="figure4.html#cb102-17" tabindex="-1"></a></span>
<span id="cb102-18"><a href="figure4.html#cb102-18" tabindex="-1"></a>met_norm <span class="ot">&lt;-</span> <span class="fu">myscale</span>(dat_met,<span class="at">method=</span><span class="st">&quot;raw_zscore&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-19"><a href="figure4.html#cb102-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample<span class="sc">$</span>CCLE_ID)</span>
<span id="cb102-20"><a href="figure4.html#cb102-20" tabindex="-1"></a></span>
<span id="cb102-21"><a href="figure4.html#cb102-21" tabindex="-1"></a>top_annotation <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>( </span>
<span id="cb102-22"><a href="figure4.html#cb102-22" tabindex="-1"></a>  <span class="at">Lineage =</span> sample<span class="sc">$</span>group,</span>
<span id="cb102-23"><a href="figure4.html#cb102-23" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">list</span>(<span class="at">Lineage=</span><span class="fu">c</span>(<span class="st">&quot;acute_myeloid_leukaemia&quot;</span><span class="ot">=</span><span class="st">&quot;#D01910&quot;</span>,</span>
<span id="cb102-24"><a href="figure4.html#cb102-24" tabindex="-1"></a>                     <span class="st">&quot;acute_lymphoblastic_leukaemia&quot;</span><span class="ot">=</span><span class="st">&quot;#4B0082&quot;</span>)),</span>
<span id="cb102-25"><a href="figure4.html#cb102-25" tabindex="-1"></a>  <span class="co"># show_legend = c(T,T,T), # 是否显示图例</span></span>
<span id="cb102-26"><a href="figure4.html#cb102-26" tabindex="-1"></a>  <span class="at">show_annotation_name =</span> <span class="fu">c</span>(T,T), <span class="co"># 是否显示注释名</span></span>
<span id="cb102-27"><a href="figure4.html#cb102-27" tabindex="-1"></a>  <span class="at">border =</span> <span class="fu">c</span>(T,T) ,<span class="co"># 是否显示边框</span></span>
<span id="cb102-28"><a href="figure4.html#cb102-28" tabindex="-1"></a>  <span class="at">simple_anno_size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;mm&quot;</span>),<span class="at">gap =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;mm&quot;</span>)</span>
<span id="cb102-29"><a href="figure4.html#cb102-29" tabindex="-1"></a>)</span>
<span id="cb102-30"><a href="figure4.html#cb102-30" tabindex="-1"></a></span>
<span id="cb102-31"><a href="figure4.html#cb102-31" tabindex="-1"></a>col_fun <span class="ot">=</span> circlize<span class="sc">::</span><span class="fu">colorRamp2</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">0</span>, <span class="fl">1.5</span>), <span class="fu">c</span>(<span class="st">&quot;#00599F&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;#D01910&quot;</span>))</span>
<span id="cb102-32"><a href="figure4.html#cb102-32" tabindex="-1"></a></span>
<span id="cb102-33"><a href="figure4.html#cb102-33" tabindex="-1"></a>p_metabolite <span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(met_norm,<span class="at">height=</span><span class="fu">unit</span>(<span class="dv">15</span>,<span class="st">&quot;cm&quot;</span>),<span class="at">name=</span><span class="st">&quot;Metabolite Data&quot;</span>,</span>
<span id="cb102-34"><a href="figure4.html#cb102-34" tabindex="-1"></a>                        <span class="at">top_annotation =</span>top_annotation,</span>
<span id="cb102-35"><a href="figure4.html#cb102-35" tabindex="-1"></a>                        <span class="at">cluster_column_slices =</span> F,</span>
<span id="cb102-36"><a href="figure4.html#cb102-36" tabindex="-1"></a>                        <span class="at">clustering_method_columns =</span> <span class="st">&quot;complete&quot;</span>,</span>
<span id="cb102-37"><a href="figure4.html#cb102-37" tabindex="-1"></a>                        <span class="at">show_row_dend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb102-38"><a href="figure4.html#cb102-38" tabindex="-1"></a>                        <span class="at">show_column_dend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb102-39"><a href="figure4.html#cb102-39" tabindex="-1"></a>                        <span class="at">column_split =</span> sample<span class="sc">$</span>group,</span>
<span id="cb102-40"><a href="figure4.html#cb102-40" tabindex="-1"></a>                        <span class="co">#  clustering_distance_columns =&quot;pearson&quot;,</span></span>
<span id="cb102-41"><a href="figure4.html#cb102-41" tabindex="-1"></a>                        <span class="at">col =</span> col_fun,</span>
<span id="cb102-42"><a href="figure4.html#cb102-42" tabindex="-1"></a>                        <span class="co"># column_split = group,cluster_column_slices = F,</span></span>
<span id="cb102-43"><a href="figure4.html#cb102-43" tabindex="-1"></a>                        <span class="co">#column_split = 6,row_split=6,show_column_names = TRUE,</span></span>
<span id="cb102-44"><a href="figure4.html#cb102-44" tabindex="-1"></a>                        </span>
<span id="cb102-45"><a href="figure4.html#cb102-45" tabindex="-1"></a>                        <span class="at">show_column_names =</span> F,</span>
<span id="cb102-46"><a href="figure4.html#cb102-46" tabindex="-1"></a>                        <span class="at">show_row_names =</span> F,</span>
<span id="cb102-47"><a href="figure4.html#cb102-47" tabindex="-1"></a>                        <span class="at">row_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">2</span>),<span class="at">column_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">5</span>))</span>
<span id="cb102-48"><a href="figure4.html#cb102-48" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/figure4/10.heatmap.met.pdf&quot;</span>,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">10</span>)</span>
<span id="cb102-49"><a href="figure4.html#cb102-49" tabindex="-1"></a>p_metabolite                     </span>
<span id="cb102-50"><a href="figure4.html#cb102-50" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb102-51"><a href="figure4.html#cb102-51" tabindex="-1"></a></span>
<span id="cb102-52"><a href="figure4.html#cb102-52" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;result/figure4/10.heatmap.met.png&quot;</span>,<span class="at">width=</span><span class="dv">800</span>,<span class="at">height =</span> <span class="dv">500</span>)</span>
<span id="cb102-53"><a href="figure4.html#cb102-53" tabindex="-1"></a>p_metabolite                     </span>
<span id="cb102-54"><a href="figure4.html#cb102-54" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb102-55"><a href="figure4.html#cb102-55" tabindex="-1"></a></span>
<span id="cb102-56"><a href="figure4.html#cb102-56" tabindex="-1"></a><span class="do">## Heatmap_gene</span></span>
<span id="cb102-57"><a href="figure4.html#cb102-57" tabindex="-1"></a>diff_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/diff_gene.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-58"><a href="figure4.html#cb102-58" tabindex="-1"></a> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb102-59"><a href="figure4.html#cb102-59" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(logFC) <span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-60"><a href="figure4.html#cb102-60" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P.Value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb102-61"><a href="figure4.html#cb102-61" tabindex="-1"></a></span>
<span id="cb102-62"><a href="figure4.html#cb102-62" tabindex="-1"></a>dat_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/0.data_gene.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-63"><a href="figure4.html#cb102-63" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb102-64"><a href="figure4.html#cb102-64" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(V1 <span class="sc">%in%</span> diff_gene<span class="sc">$</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb102-65"><a href="figure4.html#cb102-65" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;V1&quot;</span>)</span>
<span id="cb102-66"><a href="figure4.html#cb102-66" tabindex="-1"></a>sample <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/0.sample.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-67"><a href="figure4.html#cb102-67" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb102-68"><a href="figure4.html#cb102-68" tabindex="-1"></a></span>
<span id="cb102-69"><a href="figure4.html#cb102-69" tabindex="-1"></a>gene_norm <span class="ot">&lt;-</span> <span class="fu">myscale</span>(dat_gene,<span class="at">method=</span><span class="st">&quot;raw_zscore&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-70"><a href="figure4.html#cb102-70" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample<span class="sc">$</span>CCLE_ID)</span>
<span id="cb102-71"><a href="figure4.html#cb102-71" tabindex="-1"></a></span>
<span id="cb102-72"><a href="figure4.html#cb102-72" tabindex="-1"></a>top_annotation <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(</span>
<span id="cb102-73"><a href="figure4.html#cb102-73" tabindex="-1"></a>  <span class="at">Lineage =</span> sample<span class="sc">$</span>group,</span>
<span id="cb102-74"><a href="figure4.html#cb102-74" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">list</span>(<span class="at">Lineage=</span><span class="fu">c</span>(<span class="st">&quot;acute_myeloid_leukaemia&quot;</span><span class="ot">=</span><span class="st">&quot;#D01910&quot;</span>,</span>
<span id="cb102-75"><a href="figure4.html#cb102-75" tabindex="-1"></a>                     <span class="st">&quot;acute_lymphoblastic_leukaemia&quot;</span><span class="ot">=</span><span class="st">&quot;#4B0082&quot;</span>)),</span>
<span id="cb102-76"><a href="figure4.html#cb102-76" tabindex="-1"></a>  <span class="co"># show_legend = c(T,T,T), # 是否显示图例</span></span>
<span id="cb102-77"><a href="figure4.html#cb102-77" tabindex="-1"></a>  <span class="at">show_annotation_name =</span> <span class="fu">c</span>(T,T), <span class="co"># 是否显示注释名</span></span>
<span id="cb102-78"><a href="figure4.html#cb102-78" tabindex="-1"></a>  <span class="at">border =</span> <span class="fu">c</span>(T,T) ,<span class="co"># 是否显示边框</span></span>
<span id="cb102-79"><a href="figure4.html#cb102-79" tabindex="-1"></a>  <span class="at">simple_anno_size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;mm&quot;</span>),<span class="at">gap =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;mm&quot;</span>)</span>
<span id="cb102-80"><a href="figure4.html#cb102-80" tabindex="-1"></a>)</span>
<span id="cb102-81"><a href="figure4.html#cb102-81" tabindex="-1"></a></span>
<span id="cb102-82"><a href="figure4.html#cb102-82" tabindex="-1"></a>col_fun <span class="ot">=</span> circlize<span class="sc">::</span><span class="fu">colorRamp2</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">0</span>, <span class="fl">1.5</span>), <span class="fu">c</span>(<span class="st">&quot;#00599F&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;#D01910&quot;</span>))</span>
<span id="cb102-83"><a href="figure4.html#cb102-83" tabindex="-1"></a></span>
<span id="cb102-84"><a href="figure4.html#cb102-84" tabindex="-1"></a>p_gene <span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(gene_norm,<span class="at">height=</span><span class="fu">unit</span>(<span class="dv">15</span>,<span class="st">&quot;cm&quot;</span>),<span class="at">name=</span><span class="st">&quot;Metabolite Data&quot;</span>,</span>
<span id="cb102-85"><a href="figure4.html#cb102-85" tabindex="-1"></a>                        <span class="at">top_annotation =</span>top_annotation,</span>
<span id="cb102-86"><a href="figure4.html#cb102-86" tabindex="-1"></a>                        <span class="at">cluster_column_slices =</span> F,</span>
<span id="cb102-87"><a href="figure4.html#cb102-87" tabindex="-1"></a>                        <span class="at">clustering_method_columns =</span> <span class="st">&quot;complete&quot;</span>,</span>
<span id="cb102-88"><a href="figure4.html#cb102-88" tabindex="-1"></a>                        <span class="at">show_row_dend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb102-89"><a href="figure4.html#cb102-89" tabindex="-1"></a>                        <span class="at">show_column_dend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb102-90"><a href="figure4.html#cb102-90" tabindex="-1"></a>                        <span class="at">column_split =</span> sample<span class="sc">$</span>group,</span>
<span id="cb102-91"><a href="figure4.html#cb102-91" tabindex="-1"></a>                        <span class="co">#  clustering_distance_columns =&quot;pearson&quot;,</span></span>
<span id="cb102-92"><a href="figure4.html#cb102-92" tabindex="-1"></a>                        <span class="at">col =</span> col_fun,</span>
<span id="cb102-93"><a href="figure4.html#cb102-93" tabindex="-1"></a>                        <span class="at">show_column_names =</span> F,</span>
<span id="cb102-94"><a href="figure4.html#cb102-94" tabindex="-1"></a>                        <span class="at">show_row_names =</span> F,</span>
<span id="cb102-95"><a href="figure4.html#cb102-95" tabindex="-1"></a>                        <span class="at">row_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">2</span>),<span class="at">column_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">5</span>))</span>
<span id="cb102-96"><a href="figure4.html#cb102-96" tabindex="-1"></a></span>
<span id="cb102-97"><a href="figure4.html#cb102-97" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/figure4/10.heatmap.gene.pdf&quot;</span>,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">10</span>)</span>
<span id="cb102-98"><a href="figure4.html#cb102-98" tabindex="-1"></a>p_gene</span>
<span id="cb102-99"><a href="figure4.html#cb102-99" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb102-100"><a href="figure4.html#cb102-100" tabindex="-1"></a></span>
<span id="cb102-101"><a href="figure4.html#cb102-101" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;result/figure4/10.heatmap.gene.png&quot;</span>,<span class="at">width=</span><span class="dv">800</span>,<span class="at">height =</span> <span class="dv">500</span>)</span>
<span id="cb102-102"><a href="figure4.html#cb102-102" tabindex="-1"></a>p_gene</span>
<span id="cb102-103"><a href="figure4.html#cb102-103" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p>Metabolite、Gene</p>
<p><img src="result/figure4/10.heatmap.met.png" width="50%" /><img src="result/figure4/10.heatmap.gene.png" width="50%" /></p>
</div>
<div id="subnetwork-1" class="section level2 hasAnchor" number="7.9">
<h2><span class="header-section-number">7.9</span> Subnetwork<a href="figure4.html#subnetwork-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="figure4.html#cb103-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb103-2"><a href="figure4.html#cb103-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb103-3"><a href="figure4.html#cb103-3" tabindex="-1"></a></span>
<span id="cb103-4"><a href="figure4.html#cb103-4" tabindex="-1"></a>diff_meta <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/diff_met.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-5"><a href="figure4.html#cb103-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb103-6"><a href="figure4.html#cb103-6" tabindex="-1"></a>kid <span class="ot">&lt;-</span> <span class="fu">name2keggid</span>(diff_meta<span class="sc">$</span>name)</span>
<span id="cb103-7"><a href="figure4.html#cb103-7" tabindex="-1"></a>kid1 <span class="ot">&lt;-</span> kid <span class="sc">%&gt;%</span></span>
<span id="cb103-8"><a href="figure4.html#cb103-8" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_rows</span>(KEGG_id,<span class="at">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb103-9"><a href="figure4.html#cb103-9" tabindex="-1"></a></span>
<span id="cb103-10"><a href="figure4.html#cb103-10" tabindex="-1"></a>diff_meta <span class="ot">&lt;-</span> diff_meta <span class="sc">%&gt;%</span></span>
<span id="cb103-11"><a href="figure4.html#cb103-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kid1,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;Name&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb103-12"><a href="figure4.html#cb103-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(KEGG_id)) <span class="sc">%&gt;%</span></span>
<span id="cb103-13"><a href="figure4.html#cb103-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(P.Value) <span class="sc">%&gt;%</span></span>
<span id="cb103-14"><a href="figure4.html#cb103-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(KEGG_id,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb103-15"><a href="figure4.html#cb103-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb103-16"><a href="figure4.html#cb103-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;KEGG_id&quot;</span>)</span>
<span id="cb103-17"><a href="figure4.html#cb103-17" tabindex="-1"></a></span>
<span id="cb103-18"><a href="figure4.html#cb103-18" tabindex="-1"></a></span>
<span id="cb103-19"><a href="figure4.html#cb103-19" tabindex="-1"></a>diff_gene <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/figure4/diff_gene.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-20"><a href="figure4.html#cb103-20" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb103-21"><a href="figure4.html#cb103-21" tabindex="-1"></a></span>
<span id="cb103-22"><a href="figure4.html#cb103-22" tabindex="-1"></a><span class="fu">names</span>(diff_meta)[<span class="dv">4</span>]  <span class="ot">&lt;-</span> <span class="st">&quot;p_value&quot;</span></span>
<span id="cb103-23"><a href="figure4.html#cb103-23" tabindex="-1"></a><span class="fu">names</span>(diff_gene)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">&quot;p_value&quot;</span></span>
<span id="cb103-24"><a href="figure4.html#cb103-24" tabindex="-1"></a></span>
<span id="cb103-25"><a href="figure4.html#cb103-25" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/figure4/11.pdnet.pdf&quot;</span>,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">10</span>)</span>
<span id="cb103-26"><a href="figure4.html#cb103-26" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">pdnet</span>(diff_meta,diff_gene,<span class="at">nsize=</span><span class="dv">60</span>)</span>
<span id="cb103-27"><a href="figure4.html#cb103-27" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb103-28"><a href="figure4.html#cb103-28" tabindex="-1"></a></span>
<span id="cb103-29"><a href="figure4.html#cb103-29" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;result/figure4/11.pdnet.png&quot;</span>,<span class="at">width=</span><span class="dv">800</span>,<span class="at">height =</span> <span class="dv">800</span>)</span>
<span id="cb103-30"><a href="figure4.html#cb103-30" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">pdnet</span>(diff_meta,diff_gene,<span class="at">nsize=</span><span class="dv">60</span>)</span>
<span id="cb103-31"><a href="figure4.html#cb103-31" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb103-32"><a href="figure4.html#cb103-32" tabindex="-1"></a></span>
<span id="cb103-33"><a href="figure4.html#cb103-33" tabindex="-1"></a>node <span class="ot">&lt;-</span> a<span class="sc">$</span>node_result</span>
<span id="cb103-34"><a href="figure4.html#cb103-34" tabindex="-1"></a><span class="fu">write.table</span>(node,<span class="st">&quot;result/figure4/11.pdnet_node.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb103-35"><a href="figure4.html#cb103-35" tabindex="-1"></a></span>
<span id="cb103-36"><a href="figure4.html#cb103-36" tabindex="-1"></a>edge <span class="ot">&lt;-</span> a<span class="sc">$</span>edge_result</span>
<span id="cb103-37"><a href="figure4.html#cb103-37" tabindex="-1"></a><span class="fu">write.table</span>(edge,<span class="st">&quot;result/figure4/11.pdnet_edge.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
<p><img src="result/figure4/11.pdnet.png" width="70%" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="figure1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="session-information.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/06-figure4.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
